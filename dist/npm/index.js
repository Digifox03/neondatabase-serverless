"use strict";var Fa=Object.create;var qe=Object.defineProperty;var ka=Object.getOwnPropertyDescriptor;var Na=Object.getOwnPropertyNames;var Da=Object.getPrototypeOf,Oa=Object.prototype.hasOwnProperty;var qa=(r,e,t)=>e in r?qe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e)=>qe(r,"name",{value:e,configurable:!0});var ee=(r,e)=>()=>(r&&(e=r(r=0)),e);var L=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),we=(r,e)=>{for(var t in e)qe(r,t,{get:e[t],enumerable:!0})},Dn=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Na(e))!Oa.call(r,i)&&i!==t&&qe(r,i,{get:()=>e[i],enumerable:!(n=ka(e,i))||n.enumerable});return r};var st=(r,e,t)=>(t=r!=null?Fa(Da(r)):{},Dn(e||!r||!r.__esModule?qe(t,"default",{value:r,enumerable:!0}):t,r)),K=r=>Dn(qe({},"__esModule",{value:!0}),r);var S=(r,e,t)=>(qa(r,typeof e!="symbol"?e+"":e,t),t);var Qn=L(It=>{"use strict";p();It.byteLength=Ha;It.toByteArray=Ka;It.fromByteArray=Ga;var Ee=[],ge=[],Qa=typeof Uint8Array<"u"?Uint8Array:Array,Cr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Me=0,On=Cr.length;Me<On;++Me)Ee[Me]=Cr[Me],ge[Cr.charCodeAt(Me)]=Me;var Me,On;ge["-".charCodeAt(0)]=62;ge["_".charCodeAt(0)]=63;function qn(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}o(qn,"getLens");function Ha(r){var e=qn(r),t=e[0],n=e[1];return(t+n)*3/4-n}o(Ha,"byteLength");function ja(r,e,t){return(e+t)*3/4-t}o(ja,"_byteLength");function Ka(r){var e,t=qn(r),n=t[0],i=t[1],s=new Qa(ja(r,n,i)),a=0,u=i>0?n-4:n,c;for(c=0;c<u;c+=4)e=ge[r.charCodeAt(c)]<<18|ge[r.charCodeAt(c+1)]<<12|ge[r.charCodeAt(c+2)]<<6|ge[r.charCodeAt(c+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=ge[r.charCodeAt(c)]<<2|ge[r.charCodeAt(c+1)]>>4,s[a++]=e&255),i===1&&(e=ge[r.charCodeAt(c)]<<10|ge[r.charCodeAt(c+1)]<<4|ge[r.charCodeAt(c+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}o(Ka,"toByteArray");function $a(r){return Ee[r>>18&63]+Ee[r>>12&63]+Ee[r>>6&63]+Ee[r&63]}o($a,"tripletToBase64");function Wa(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push($a(n));return i.join("")}o(Wa,"encodeChunk");function Ga(r){for(var e,t=r.length,n=t%3,i=[],s=16383,a=0,u=t-n;a<u;a+=s)i.push(Wa(r,a,a+s>u?u:a+s));return n===1?(e=r[t-1],i.push(Ee[e>>2]+Ee[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(Ee[e>>10]+Ee[e>>4&63]+Ee[e<<2&63]+"=")),i.join("")}o(Ga,"fromByteArray")});var Hn=L(Ur=>{p();Ur.read=function(r,e,t,n,i){var s,a,u=i*8-n-1,c=(1<<u)-1,h=c>>1,l=-7,f=t?i-1:0,m=t?-1:1,b=r[e+f];for(f+=m,s=b&(1<<-l)-1,b>>=-l,l+=u;l>0;s=s*256+r[e+f],f+=m,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=n;l>0;a=a*256+r[e+f],f+=m,l-=8);if(s===0)s=1-h;else{if(s===c)return a?NaN:(b?-1:1)*(1/0);a=a+Math.pow(2,n),s=s-h}return(b?-1:1)*a*Math.pow(2,s-n)};Ur.write=function(r,e,t,n,i,s){var a,u,c,h=s*8-i-1,l=(1<<h)-1,f=l>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:s-1,x=n?1:-1,I=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+f>=1?e+=m/c:e+=m*Math.pow(2,1-f),e*c>=2&&(a++,c/=2),a+f>=l?(u=0,a=l):a+f>=1?(u=(e*c-1)*Math.pow(2,i),a=a+f):(u=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;r[t+b]=u&255,b+=x,u/=256,i-=8);for(a=a<<i|u,h+=i;h>0;r[t+b]=a&255,b+=x,a/=256,h-=8);r[t+b-x]|=I*128}});var si=L(Ke=>{"use strict";p();var Ir=Qn(),He=Hn(),jn=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Ke.Buffer=d;Ke.SlowBuffer=Xa;Ke.INSPECT_MAX_BYTES=50;var Lt=2147483647;Ke.kMaxLength=Lt;d.TYPED_ARRAY_SUPPORT=Va();!d.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Va(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}o(Va,"typedArraySupport");Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(!!d.isBuffer(this))return this.buffer}});Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(!!d.isBuffer(this))return this.byteOffset}});function Ue(r){if(r>Lt)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,d.prototype),e}o(Ue,"createBuffer");function d(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Pr(r)}return Gn(r,e,t)}o(d,"Buffer");d.poolSize=8192;function Gn(r,e,t){if(typeof r=="string")return Ja(r,e);if(ArrayBuffer.isView(r))return Ya(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(ve(r,ArrayBuffer)||r&&ve(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ve(r,SharedArrayBuffer)||r&&ve(r.buffer,SharedArrayBuffer)))return Tr(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return d.from(n,e,t);let i=Za(r);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return d.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}o(Gn,"from");d.from=function(r,e,t){return Gn(r,e,t)};Object.setPrototypeOf(d.prototype,Uint8Array.prototype);Object.setPrototypeOf(d,Uint8Array);function Vn(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}o(Vn,"assertSize");function za(r,e,t){return Vn(r),r<=0?Ue(r):e!==void 0?typeof t=="string"?Ue(r).fill(e,t):Ue(r).fill(e):Ue(r)}o(za,"alloc");d.alloc=function(r,e,t){return za(r,e,t)};function Pr(r){return Vn(r),Ue(r<0?0:Rr(r)|0)}o(Pr,"allocUnsafe");d.allocUnsafe=function(r){return Pr(r)};d.allocUnsafeSlow=function(r){return Pr(r)};function Ja(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!d.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=zn(r,e)|0,n=Ue(t),i=n.write(r,e);return i!==t&&(n=n.slice(0,i)),n}o(Ja,"fromString");function Lr(r){let e=r.length<0?0:Rr(r.length)|0,t=Ue(e);for(let n=0;n<e;n+=1)t[n]=r[n]&255;return t}o(Lr,"fromArrayLike");function Ya(r){if(ve(r,Uint8Array)){let e=new Uint8Array(r);return Tr(e.buffer,e.byteOffset,e.byteLength)}return Lr(r)}o(Ya,"fromArrayView");function Tr(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&t===void 0?n=new Uint8Array(r):t===void 0?n=new Uint8Array(r,e):n=new Uint8Array(r,e,t),Object.setPrototypeOf(n,d.prototype),n}o(Tr,"fromArrayBuffer");function Za(r){if(d.isBuffer(r)){let e=Rr(r.length)|0,t=Ue(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Fr(r.length)?Ue(0):Lr(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Lr(r.data)}o(Za,"fromObject");function Rr(r){if(r>=Lt)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Lt.toString(16)+" bytes");return r|0}o(Rr,"checked");function Xa(r){return+r!=r&&(r=0),d.alloc(+r)}o(Xa,"SlowBuffer");d.isBuffer=o(function(e){return e!=null&&e._isBuffer===!0&&e!==d.prototype},"isBuffer");d.compare=o(function(e,t){if(ve(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),ve(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let s=0,a=Math.min(n,i);s<a;++s)if(e[s]!==t[s]){n=e[s],i=t[s];break}return n<i?-1:i<n?1:0},"compare");d.isEncoding=o(function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding");d.concat=o(function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return d.alloc(0);let n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;let i=d.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){let a=e[n];if(ve(a,Uint8Array))s+a.length>i.length?(d.isBuffer(a)||(a=d.from(a)),a.copy(i,s)):Uint8Array.prototype.set.call(i,a,s);else if(d.isBuffer(a))a.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=a.length}return i},"concat");function zn(r,e){if(d.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||ve(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&t===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Br(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return ii(r).length;default:if(i)return n?-1:Br(r).length;e=(""+e).toLowerCase(),i=!0}}o(zn,"byteLength");d.byteLength=zn;function eo(r,e,t){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return ho(this,e,t);case"utf8":case"utf-8":return Yn(this,e,t);case"ascii":return uo(this,e,t);case"latin1":case"binary":return co(this,e,t);case"base64":return ao(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lo(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}o(eo,"slowToString");d.prototype._isBuffer=!0;function Fe(r,e,t){let n=r[e];r[e]=r[t],r[t]=n}o(Fe,"swap");d.prototype.swap16=o(function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)Fe(this,t,t+1);return this},"swap16");d.prototype.swap32=o(function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)Fe(this,t,t+3),Fe(this,t+1,t+2);return this},"swap32");d.prototype.swap64=o(function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)Fe(this,t,t+7),Fe(this,t+1,t+6),Fe(this,t+2,t+5),Fe(this,t+3,t+4);return this},"swap64");d.prototype.toString=o(function(){let e=this.length;return e===0?"":arguments.length===0?Yn(this,0,e):eo.apply(this,arguments)},"toString");d.prototype.toLocaleString=d.prototype.toString;d.prototype.equals=o(function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:d.compare(this,e)===0},"equals");d.prototype.inspect=o(function(){let e="",t=Ke.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},"inspect");jn&&(d.prototype[jn]=d.prototype.inspect);d.prototype.compare=o(function(e,t,n,i,s){if(ve(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),t<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&t>=n)return 0;if(i>=s)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;let a=s-i,u=n-t,c=Math.min(a,u),h=this.slice(i,s),l=e.slice(t,n);for(let f=0;f<c;++f)if(h[f]!==l[f]){a=h[f],u=l[f];break}return a<u?-1:u<a?1:0},"compare");function Jn(r,e,t,n,i){if(r.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Fr(t)&&(t=i?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(i)return-1;t=r.length-1}else if(t<0)if(i)t=0;else return-1;if(typeof e=="string"&&(e=d.from(e,n)),d.isBuffer(e))return e.length===0?-1:Kn(r,e,t,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Kn(r,[e],t,n,i);throw new TypeError("val must be string, number or Buffer")}o(Jn,"bidirectionalIndexOf");function Kn(r,e,t,n,i){let s=1,a=r.length,u=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,a/=2,u/=2,t/=2}function c(l,f){return s===1?l[f]:l.readUInt16BE(f*s)}o(c,"read");let h;if(i){let l=-1;for(h=t;h<a;h++)if(c(r,h)===c(e,l===-1?0:h-l)){if(l===-1&&(l=h),h-l+1===u)return l*s}else l!==-1&&(h-=h-l),l=-1}else for(t+u>a&&(t=a-u),h=t;h>=0;h--){let l=!0;for(let f=0;f<u;f++)if(c(r,h+f)!==c(e,f)){l=!1;break}if(l)return h}return-1}o(Kn,"arrayIndexOf");d.prototype.includes=o(function(e,t,n){return this.indexOf(e,t,n)!==-1},"includes");d.prototype.indexOf=o(function(e,t,n){return Jn(this,e,t,n,!0)},"indexOf");d.prototype.lastIndexOf=o(function(e,t,n){return Jn(this,e,t,n,!1)},"lastIndexOf");function to(r,e,t,n){t=Number(t)||0;let i=r.length-t;n?(n=Number(n),n>i&&(n=i)):n=i;let s=e.length;n>s/2&&(n=s/2);let a;for(a=0;a<n;++a){let u=parseInt(e.substr(a*2,2),16);if(Fr(u))return a;r[t+a]=u}return a}o(to,"hexWrite");function ro(r,e,t,n){return Tt(Br(e,r.length-t),r,t,n)}o(ro,"utf8Write");function no(r,e,t,n){return Tt(wo(e),r,t,n)}o(no,"asciiWrite");function io(r,e,t,n){return Tt(ii(e),r,t,n)}o(io,"base64Write");function so(r,e,t,n){return Tt(mo(e,r.length-t),r,t,n)}o(so,"ucs2Write");d.prototype.write=o(function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let a=!1;for(;;)switch(i){case"hex":return to(this,e,t,n);case"utf8":case"utf-8":return ro(this,e,t,n);case"ascii":case"latin1":case"binary":return no(this,e,t,n);case"base64":return io(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return so(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},"write");d.prototype.toJSON=o(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function ao(r,e,t){return e===0&&t===r.length?Ir.fromByteArray(r):Ir.fromByteArray(r.slice(e,t))}o(ao,"base64Slice");function Yn(r,e,t){t=Math.min(r.length,t);let n=[],i=e;for(;i<t;){let s=r[i],a=null,u=s>239?4:s>223?3:s>191?2:1;if(i+u<=t){let c,h,l,f;switch(u){case 1:s<128&&(a=s);break;case 2:c=r[i+1],(c&192)===128&&(f=(s&31)<<6|c&63,f>127&&(a=f));break;case 3:c=r[i+1],h=r[i+2],(c&192)===128&&(h&192)===128&&(f=(s&15)<<12|(c&63)<<6|h&63,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:c=r[i+1],h=r[i+2],l=r[i+3],(c&192)===128&&(h&192)===128&&(l&192)===128&&(f=(s&15)<<18|(c&63)<<12|(h&63)<<6|l&63,f>65535&&f<1114112&&(a=f))}}a===null?(a=65533,u=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|a&1023),n.push(a),i+=u}return oo(n)}o(Yn,"utf8Slice");var $n=4096;function oo(r){let e=r.length;if(e<=$n)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=$n));return t}o(oo,"decodeCodePointsArray");function uo(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]&127);return n}o(uo,"asciiSlice");function co(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]);return n}o(co,"latin1Slice");function ho(r,e,t){let n=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);let i="";for(let s=e;s<t;++s)i+=go[r[s]];return i}o(ho,"hexSlice");function lo(r,e,t){let n=r.slice(e,t),i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}o(lo,"utf16leSlice");d.prototype.slice=o(function(e,t){let n=this.length;e=~~e,t=t===void 0?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,d.prototype),i},"slice");function z(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}o(z,"checkOffset");d.prototype.readUintLE=d.prototype.readUIntLE=o(function(e,t,n){e=e>>>0,t=t>>>0,n||z(e,t,this.length);let i=this[e],s=1,a=0;for(;++a<t&&(s*=256);)i+=this[e+a]*s;return i},"readUIntLE");d.prototype.readUintBE=d.prototype.readUIntBE=o(function(e,t,n){e=e>>>0,t=t>>>0,n||z(e,t,this.length);let i=this[e+--t],s=1;for(;t>0&&(s*=256);)i+=this[e+--t]*s;return i},"readUIntBE");d.prototype.readUint8=d.prototype.readUInt8=o(function(e,t){return e=e>>>0,t||z(e,1,this.length),this[e]},"readUInt8");d.prototype.readUint16LE=d.prototype.readUInt16LE=o(function(e,t){return e=e>>>0,t||z(e,2,this.length),this[e]|this[e+1]<<8},"readUInt16LE");d.prototype.readUint16BE=d.prototype.readUInt16BE=o(function(e,t){return e=e>>>0,t||z(e,2,this.length),this[e]<<8|this[e+1]},"readUInt16BE");d.prototype.readUint32LE=d.prototype.readUInt32LE=o(function(e,t){return e=e>>>0,t||z(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},"readUInt32LE");d.prototype.readUint32BE=d.prototype.readUInt32BE=o(function(e,t){return e=e>>>0,t||z(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},"readUInt32BE");d.prototype.readBigUInt64LE=Te(o(function(e){e=e>>>0,je(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&at(e,this.length-8);let i=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(s)<<BigInt(32))},"readBigUInt64LE"));d.prototype.readBigUInt64BE=Te(o(function(e){e=e>>>0,je(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&at(e,this.length-8);let i=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(s)},"readBigUInt64BE"));d.prototype.readIntLE=o(function(e,t,n){e=e>>>0,t=t>>>0,n||z(e,t,this.length);let i=this[e],s=1,a=0;for(;++a<t&&(s*=256);)i+=this[e+a]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},"readIntLE");d.prototype.readIntBE=o(function(e,t,n){e=e>>>0,t=t>>>0,n||z(e,t,this.length);let i=t,s=1,a=this[e+--i];for(;i>0&&(s*=256);)a+=this[e+--i]*s;return s*=128,a>=s&&(a-=Math.pow(2,8*t)),a},"readIntBE");d.prototype.readInt8=o(function(e,t){return e=e>>>0,t||z(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},"readInt8");d.prototype.readInt16LE=o(function(e,t){e=e>>>0,t||z(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n},"readInt16LE");d.prototype.readInt16BE=o(function(e,t){e=e>>>0,t||z(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n},"readInt16BE");d.prototype.readInt32LE=o(function(e,t){return e=e>>>0,t||z(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},"readInt32LE");d.prototype.readInt32BE=o(function(e,t){return e=e>>>0,t||z(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},"readInt32BE");d.prototype.readBigInt64LE=Te(o(function(e){e=e>>>0,je(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&at(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)},"readBigInt64LE"));d.prototype.readBigInt64BE=Te(o(function(e){e=e>>>0,je(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&at(e,this.length-8);let i=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)},"readBigInt64BE"));d.prototype.readFloatLE=o(function(e,t){return e=e>>>0,t||z(e,4,this.length),He.read(this,e,!0,23,4)},"readFloatLE");d.prototype.readFloatBE=o(function(e,t){return e=e>>>0,t||z(e,4,this.length),He.read(this,e,!1,23,4)},"readFloatBE");d.prototype.readDoubleLE=o(function(e,t){return e=e>>>0,t||z(e,8,this.length),He.read(this,e,!0,52,8)},"readDoubleLE");d.prototype.readDoubleBE=o(function(e,t){return e=e>>>0,t||z(e,8,this.length),He.read(this,e,!1,52,8)},"readDoubleBE");function he(r,e,t,n,i,s){if(!d.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(t+n>r.length)throw new RangeError("Index out of range")}o(he,"checkInt");d.prototype.writeUintLE=d.prototype.writeUIntLE=o(function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let u=Math.pow(2,8*n)-1;he(this,e,t,n,u,0)}let s=1,a=0;for(this[t]=e&255;++a<n&&(s*=256);)this[t+a]=e/s&255;return t+n},"writeUIntLE");d.prototype.writeUintBE=d.prototype.writeUIntBE=o(function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let u=Math.pow(2,8*n)-1;he(this,e,t,n,u,0)}let s=n-1,a=1;for(this[t+s]=e&255;--s>=0&&(a*=256);)this[t+s]=e/a&255;return t+n},"writeUIntBE");d.prototype.writeUint8=d.prototype.writeUInt8=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,1,255,0),this[t]=e&255,t+1},"writeUInt8");d.prototype.writeUint16LE=d.prototype.writeUInt16LE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},"writeUInt16LE");d.prototype.writeUint16BE=d.prototype.writeUInt16BE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},"writeUInt16BE");d.prototype.writeUint32LE=d.prototype.writeUInt32LE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},"writeUInt32LE");d.prototype.writeUint32BE=d.prototype.writeUInt32BE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},"writeUInt32BE");function Zn(r,e,t,n,i){ni(e,n,i,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let a=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=a,a=a>>8,r[t++]=a,a=a>>8,r[t++]=a,a=a>>8,r[t++]=a,t}o(Zn,"wrtBigUInt64LE");function Xn(r,e,t,n,i){ni(e,n,i,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let a=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=a,a=a>>8,r[t+2]=a,a=a>>8,r[t+1]=a,a=a>>8,r[t]=a,t+8}o(Xn,"wrtBigUInt64BE");d.prototype.writeBigUInt64LE=Te(o(function(e,t=0){return Zn(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE"));d.prototype.writeBigUInt64BE=Te(o(function(e,t=0){return Xn(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE"));d.prototype.writeIntLE=o(function(e,t,n,i){if(e=+e,t=t>>>0,!i){let c=Math.pow(2,8*n-1);he(this,e,t,n,c-1,-c)}let s=0,a=1,u=0;for(this[t]=e&255;++s<n&&(a*=256);)e<0&&u===0&&this[t+s-1]!==0&&(u=1),this[t+s]=(e/a>>0)-u&255;return t+n},"writeIntLE");d.prototype.writeIntBE=o(function(e,t,n,i){if(e=+e,t=t>>>0,!i){let c=Math.pow(2,8*n-1);he(this,e,t,n,c-1,-c)}let s=n-1,a=1,u=0;for(this[t+s]=e&255;--s>=0&&(a*=256);)e<0&&u===0&&this[t+s+1]!==0&&(u=1),this[t+s]=(e/a>>0)-u&255;return t+n},"writeIntBE");d.prototype.writeInt8=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},"writeInt8");d.prototype.writeInt16LE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},"writeInt16LE");d.prototype.writeInt16BE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},"writeInt16BE");d.prototype.writeInt32LE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},"writeInt32LE");d.prototype.writeInt32BE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},"writeInt32BE");d.prototype.writeBigInt64LE=Te(o(function(e,t=0){return Zn(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE"));d.prototype.writeBigInt64BE=Te(o(function(e,t=0){return Xn(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function ei(r,e,t,n,i,s){if(t+n>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}o(ei,"checkIEEE754");function ti(r,e,t,n,i){return e=+e,t=t>>>0,i||ei(r,e,t,4,34028234663852886e22,-34028234663852886e22),He.write(r,e,t,n,23,4),t+4}o(ti,"writeFloat");d.prototype.writeFloatLE=o(function(e,t,n){return ti(this,e,t,!0,n)},"writeFloatLE");d.prototype.writeFloatBE=o(function(e,t,n){return ti(this,e,t,!1,n)},"writeFloatBE");function ri(r,e,t,n,i){return e=+e,t=t>>>0,i||ei(r,e,t,8,17976931348623157e292,-17976931348623157e292),He.write(r,e,t,n,52,8),t+8}o(ri,"writeDouble");d.prototype.writeDoubleLE=o(function(e,t,n){return ri(this,e,t,!0,n)},"writeDoubleLE");d.prototype.writeDoubleBE=o(function(e,t,n){return ri(this,e,t,!1,n)},"writeDoubleBE");d.prototype.copy=o(function(e,t,n,i){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);let s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),s},"copy");d.prototype.fill=o(function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!d.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let a=e.charCodeAt(0);(i==="utf8"&&a<128||i==="latin1")&&(e=a)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t=t>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<n;++s)this[s]=e;else{let a=d.isBuffer(e)?e:d.from(e,i),u=a.length;if(u===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=a[s%u]}return this},"fill");var Qe={};function Mr(r,e,t){Qe[r]=o(class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}},"NodeError")}o(Mr,"E");Mr("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Mr("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);Mr("ERR_OUT_OF_RANGE",function(r,e,t){let n=`The value of "${r}" is out of range.`,i=t;return Number.isInteger(t)&&Math.abs(t)>2**32?i=Wn(String(t)):typeof t=="bigint"&&(i=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(i=Wn(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function Wn(r){let e="",t=r.length,n=r[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}o(Wn,"addNumericalSeparator");function fo(r,e,t){je(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&at(e,r.length-(t+1))}o(fo,"checkBounds");function ni(r,e,t,n,i,s){if(r>t||r<e){let a=typeof e=="bigint"?"n":"",u;throw s>3?e===0||e===BigInt(0)?u=`>= 0${a} and < 2${a} ** ${(s+1)*8}${a}`:u=`>= -(2${a} ** ${(s+1)*8-1}${a}) and < 2 ** ${(s+1)*8-1}${a}`:u=`>= ${e}${a} and <= ${t}${a}`,new Qe.ERR_OUT_OF_RANGE("value",u,r)}fo(n,i,s)}o(ni,"checkIntBI");function je(r,e){if(typeof r!="number")throw new Qe.ERR_INVALID_ARG_TYPE(e,"number",r)}o(je,"validateNumber");function at(r,e,t){throw Math.floor(r)!==r?(je(r,t),new Qe.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new Qe.ERR_BUFFER_OUT_OF_BOUNDS:new Qe.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}o(at,"boundsError");var po=/[^+/0-9A-Za-z-_]/g;function yo(r){if(r=r.split("=")[0],r=r.trim().replace(po,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}o(yo,"base64clean");function Br(r,e){e=e||1/0;let t,n=r.length,i=null,s=[];for(let a=0;a<n;++a){if(t=r.charCodeAt(a),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(a+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}o(Br,"utf8ToBytes");function wo(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}o(wo,"asciiToBytes");function mo(r,e){let t,n,i,s=[];for(let a=0;a<r.length&&!((e-=2)<0);++a)t=r.charCodeAt(a),n=t>>8,i=t%256,s.push(i),s.push(n);return s}o(mo,"utf16leToBytes");function ii(r){return Ir.toByteArray(yo(r))}o(ii,"base64ToBytes");function Tt(r,e,t,n){let i;for(i=0;i<n&&!(i+t>=e.length||i>=r.length);++i)e[i+t]=r[i];return i}o(Tt,"blitBuffer");function ve(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}o(ve,"isInstance");function Fr(r){return r!==r}o(Fr,"numberIsNaN");var go=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let n=t*16;for(let i=0;i<16;++i)e[n+i]=r[t]+r[i]}return e}();function Te(r){return typeof BigInt>"u"?So:r}o(Te,"defineBigIntMethod");function So(){throw new Error("BigInt not supported")}o(So,"BufferBigIntNotDefined")});var E,v,_,g,y,w,p=ee(()=>{"use strict";E=globalThis,v=globalThis.setImmediate??(r=>setTimeout(r,0)),_=globalThis.clearImmediate??(r=>clearTimeout(r)),g=globalThis.crypto??{};g.subtle??(g.subtle={});y=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:si().Buffer,w=globalThis.process??{};w.env??(w.env={});try{w.nextTick(()=>{})}catch{let e=Promise.resolve();w.nextTick=e.then.bind(e)}});var Ie=L((Sl,kr)=>{"use strict";p();var $e=typeof Reflect=="object"?Reflect:null,ai=$e&&typeof $e.apply=="function"?$e.apply:o(function(e,t,n){return Function.prototype.apply.call(e,t,n)},"ReflectApply"),Bt;$e&&typeof $e.ownKeys=="function"?Bt=$e.ownKeys:Object.getOwnPropertySymbols?Bt=o(function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))},"ReflectOwnKeys"):Bt=o(function(e){return Object.getOwnPropertyNames(e)},"ReflectOwnKeys");function xo(r){console&&console.warn&&console.warn(r)}o(xo,"ProcessEmitWarning");var ui=Number.isNaN||o(function(e){return e!==e},"NumberIsNaN");function F(){F.init.call(this)}o(F,"EventEmitter");kr.exports=F;kr.exports.once=vo;F.EventEmitter=F;F.prototype._events=void 0;F.prototype._eventsCount=0;F.prototype._maxListeners=void 0;var oi=10;function Pt(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}o(Pt,"checkListener");Object.defineProperty(F,"defaultMaxListeners",{enumerable:!0,get:function(){return oi},set:function(r){if(typeof r!="number"||r<0||ui(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");oi=r}});F.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};F.prototype.setMaxListeners=o(function(e){if(typeof e!="number"||e<0||ui(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},"setMaxListeners");function ci(r){return r._maxListeners===void 0?F.defaultMaxListeners:r._maxListeners}o(ci,"_getMaxListeners");F.prototype.getMaxListeners=o(function(){return ci(this)},"getMaxListeners");F.prototype.emit=o(function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var u=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw u.context=a,u}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")ai(c,this,t);else for(var h=c.length,l=pi(c,h),n=0;n<h;++n)ai(l[n],this,t);return!0},"emit");function hi(r,e,t,n){var i,s,a;if(Pt(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),a=s[e]),a===void 0)a=s[e]=t,++r._eventsCount;else if(typeof a=="function"?a=s[e]=n?[t,a]:[a,t]:n?a.unshift(t):a.push(t),i=ci(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=r,u.type=e,u.count=a.length,xo(u)}return r}o(hi,"_addListener");F.prototype.addListener=o(function(e,t){return hi(this,e,t,!1)},"addListener");F.prototype.on=F.prototype.addListener;F.prototype.prependListener=o(function(e,t){return hi(this,e,t,!0)},"prependListener");function bo(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}o(bo,"onceWrapper");function li(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=bo.bind(n);return i.listener=t,n.wrapFn=i,i}o(li,"_onceWrap");F.prototype.once=o(function(e,t){return Pt(t),this.on(e,li(this,e,t)),this},"once");F.prototype.prependOnceListener=o(function(e,t){return Pt(t),this.prependListener(e,li(this,e,t)),this},"prependOnceListener");F.prototype.removeListener=o(function(e,t){var n,i,s,a,u;if(Pt(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){u=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():Ao(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,u||t)}return this},"removeListener");F.prototype.off=F.prototype.removeListener;F.prototype.removeAllListeners=o(function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},"removeAllListeners");function fi(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Eo(i):pi(i,i.length)}o(fi,"_listeners");F.prototype.listeners=o(function(e){return fi(this,e,!0)},"listeners");F.prototype.rawListeners=o(function(e){return fi(this,e,!1)},"rawListeners");F.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):di.call(r,e)};F.prototype.listenerCount=di;function di(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}o(di,"listenerCount");F.prototype.eventNames=o(function(){return this._eventsCount>0?Bt(this._events):[]},"eventNames");function pi(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}o(pi,"arrayClone");function Ao(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}o(Ao,"spliceOne");function Eo(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}o(Eo,"unwrapListeners");function vo(r,e){return new Promise(function(t,n){function i(a){r.removeListener(e,s),n(a)}o(i,"errorListener");function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}o(s,"resolver"),yi(r,e,s,{once:!0}),e!=="error"&&_o(r,i,{once:!0})})}o(vo,"once");function _o(r,e,t){typeof r.on=="function"&&yi(r,"error",e,t)}o(_o,"addErrorHandlerIfEventEmitter");function yi(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,o(function i(s){n.once&&r.removeEventListener(e,i),t(s)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}o(yi,"eventTargetAgnosticAddListener")});var Nr=L(wi=>{"use strict";p();wi.parse=function(r,e){return new We(r,e).parse()};var We=class{constructor(e,t){this.source=e,this.transform=t||Co,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var t;(this.recorded.length>0||e)&&(t=this.recorded.join(""),t==="NULL"&&!e&&(t=null),t!==null&&(t=this.transform(t)),this.entries.push(t),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var t,n,i;for(this.consumeDimensions();!this.isEof();)if(t=this.nextCharacter(),t.value==="{"&&!i)this.dimension++,this.dimension>1&&(n=new We(this.source.substr(this.position-1),this.transform),this.entries.push(n.parse(!0)),this.position+=n.position-2);else if(t.value==="}"&&!i){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else t.value==='"'&&!t.escaped?(i&&this.newEntry(!0),i=!i):t.value===","&&!i?this.newEntry():this.record(t.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};o(We,"ArrayParser");function Co(r){return r}o(Co,"identity")});var Dr=L((_l,mi)=>{p();var Uo=Nr();mi.exports={create:function(r,e){return{parse:function(){return Uo.parse(r,e)}}}}});var xi=L((Ul,Si)=>{"use strict";p();var Io=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,Lo=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,To=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,Bo=/^-?infinity$/;Si.exports=o(function(e){if(Bo.test(e))return Number(e.replace("i","I"));var t=Io.exec(e);if(!t)return Po(e)||null;var n=!!t[8],i=parseInt(t[1],10);n&&(i=gi(i));var s=parseInt(t[2],10)-1,a=t[3],u=parseInt(t[4],10),c=parseInt(t[5],10),h=parseInt(t[6],10),l=t[7];l=l?1e3*parseFloat(l):0;var f,m=Ro(e);return m!=null?(f=new Date(Date.UTC(i,s,a,u,c,h,l)),Or(i)&&f.setUTCFullYear(i),m!==0&&f.setTime(f.getTime()-m)):(f=new Date(i,s,a,u,c,h,l),Or(i)&&f.setFullYear(i)),f},"parseDate");function Po(r){var e=Lo.exec(r);if(!!e){var t=parseInt(e[1],10),n=!!e[4];n&&(t=gi(t));var i=parseInt(e[2],10)-1,s=e[3],a=new Date(t,i,s);return Or(t)&&a.setFullYear(t),a}}o(Po,"getDate");function Ro(r){if(r.endsWith("+00"))return 0;var e=To.exec(r.split(" ")[1]);if(!!e){var t=e[1];if(t==="Z")return 0;var n=t==="-"?-1:1,i=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return i*n*1e3}}o(Ro,"timeZoneOffset");function gi(r){return-(r-1)}o(gi,"bcYearToNegativeYear");function Or(r){return r>=0&&r<100}o(Or,"is0To99")});var Ai=L((Tl,bi)=>{p();bi.exports=Fo;var Mo=Object.prototype.hasOwnProperty;function Fo(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Mo.call(t,n)&&(r[n]=t[n])}return r}o(Fo,"extend")});var _i=L((Rl,vi)=>{"use strict";p();var ko=Ai();vi.exports=Ge;function Ge(r){if(!(this instanceof Ge))return new Ge(r);ko(this,Vo(r))}o(Ge,"PostgresInterval");var No=["seconds","minutes","hours","days","months","years"];Ge.prototype.toPostgres=function(){var r=No.filter(this.hasOwnProperty,this);return this.milliseconds&&r.indexOf("seconds")<0&&r.push("seconds"),r.length===0?"0":r.map(function(e){var t=this[e]||0;return e==="seconds"&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),t+" "+e},this).join(" ")};var Do={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},Oo=["years","months","days"],qo=["hours","minutes","seconds"];Ge.prototype.toISOString=Ge.prototype.toISO=function(){var r=Oo.map(t,this).join(""),e=qo.map(t,this).join("");return"P"+r+"T"+e;function t(n){var i=this[n]||0;return n==="seconds"&&this.milliseconds&&(i=(i+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),i+Do[n]}};var qr="([+-]?\\d+)",Qo=qr+"\\s+years?",Ho=qr+"\\s+mons?",jo=qr+"\\s+days?",Ko="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",$o=new RegExp([Qo,Ho,jo,Ko].map(function(r){return"("+r+")?"}).join("\\s*")),Ei={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},Wo=["hours","minutes","seconds","milliseconds"];function Go(r){var e=r+"000000".slice(r.length);return parseInt(e,10)/1e3}o(Go,"parseMilliseconds");function Vo(r){if(!r)return{};var e=$o.exec(r),t=e[8]==="-";return Object.keys(Ei).reduce(function(n,i){var s=Ei[i],a=e[s];return!a||(a=i==="milliseconds"?Go(a):parseInt(a,10),!a)||(t&&~Wo.indexOf(i)&&(a*=-1),n[i]=a),n},{})}o(Vo,"parse")});var Ui=L((kl,Ci)=>{"use strict";p();Ci.exports=o(function(e){if(/^\\x/.test(e))return new y(e.substr(2),"hex");for(var t="",n=0;n<e.length;)if(e[n]!=="\\")t+=e[n],++n;else if(/[0-7]{3}/.test(e.substr(n+1,3)))t+=String.fromCharCode(parseInt(e.substr(n+1,3),8)),n+=4;else{for(var i=1;n+i<e.length&&e[n+i]==="\\";)i++;for(var s=0;s<Math.floor(i/2);++s)t+="\\";n+=Math.floor(i/2)*2}return new y(t,"binary")},"parseBytea")});var Mi=L((Ol,Ri)=>{p();var ot=Nr(),ut=Dr(),Rt=xi(),Li=_i(),Ti=Ui();function Mt(r){return o(function(t){return t===null?t:r(t)},"nullAllowed")}o(Mt,"allowNull");function Bi(r){return r===null?r:r==="TRUE"||r==="t"||r==="true"||r==="y"||r==="yes"||r==="on"||r==="1"}o(Bi,"parseBool");function zo(r){return r?ot.parse(r,Bi):null}o(zo,"parseBoolArray");function Jo(r){return parseInt(r,10)}o(Jo,"parseBaseTenInt");function Qr(r){return r?ot.parse(r,Mt(Jo)):null}o(Qr,"parseIntegerArray");function Yo(r){return r?ot.parse(r,Mt(function(e){return Pi(e).trim()})):null}o(Yo,"parseBigIntegerArray");var Zo=o(function(r){if(!r)return null;var e=ut.create(r,function(t){return t!==null&&(t=$r(t)),t});return e.parse()},"parsePointArray"),Hr=o(function(r){if(!r)return null;var e=ut.create(r,function(t){return t!==null&&(t=parseFloat(t)),t});return e.parse()},"parseFloatArray"),Se=o(function(r){if(!r)return null;var e=ut.create(r);return e.parse()},"parseStringArray"),jr=o(function(r){if(!r)return null;var e=ut.create(r,function(t){return t!==null&&(t=Rt(t)),t});return e.parse()},"parseDateArray"),Xo=o(function(r){if(!r)return null;var e=ut.create(r,function(t){return t!==null&&(t=Li(t)),t});return e.parse()},"parseIntervalArray"),eu=o(function(r){return r?ot.parse(r,Mt(Ti)):null},"parseByteAArray"),Kr=o(function(r){return parseInt(r,10)},"parseInteger"),Pi=o(function(r){var e=String(r);return/^\d+$/.test(e)?e:r},"parseBigInteger"),Ii=o(function(r){return r?ot.parse(r,Mt(JSON.parse)):null},"parseJsonArray"),$r=o(function(r){return r[0]!=="("?null:(r=r.substring(1,r.length-1).split(","),{x:parseFloat(r[0]),y:parseFloat(r[1])})},"parsePoint"),tu=o(function(r){if(r[0]!=="<"&&r[1]!=="(")return null;for(var e="(",t="",n=!1,i=2;i<r.length-1;i++){if(n||(e+=r[i]),r[i]===")"){n=!0;continue}else if(!n)continue;r[i]!==","&&(t+=r[i])}var s=$r(e);return s.radius=parseFloat(t),s},"parseCircle"),ru=o(function(r){r(20,Pi),r(21,Kr),r(23,Kr),r(26,Kr),r(700,parseFloat),r(701,parseFloat),r(16,Bi),r(1082,Rt),r(1114,Rt),r(1184,Rt),r(600,$r),r(651,Se),r(718,tu),r(1e3,zo),r(1001,eu),r(1005,Qr),r(1007,Qr),r(1028,Qr),r(1016,Yo),r(1017,Zo),r(1021,Hr),r(1022,Hr),r(1231,Hr),r(1014,Se),r(1015,Se),r(1008,Se),r(1009,Se),r(1040,Se),r(1041,Se),r(1115,jr),r(1182,jr),r(1185,jr),r(1186,Li),r(1187,Xo),r(17,Ti),r(114,JSON.parse.bind(JSON)),r(3802,JSON.parse.bind(JSON)),r(199,Ii),r(3807,Ii),r(3907,Se),r(2951,Se),r(791,Se),r(1183,Se),r(1270,Se)},"init");Ri.exports={init:ru}});var ki=L((Hl,Fi)=>{"use strict";p();var le=1e6;function nu(r){var e=r.readInt32BE(0),t=r.readUInt32BE(4),n="";e<0&&(e=~e+(t===0),t=~t+1>>>0,n="-");var i="",s,a,u,c,h,l;{if(s=e%le,e=e/le>>>0,a=4294967296*s+t,t=a/le>>>0,u=""+(a-le*t),t===0&&e===0)return n+u+i;for(c="",h=6-u.length,l=0;l<h;l++)c+="0";i=c+u+i}{if(s=e%le,e=e/le>>>0,a=4294967296*s+t,t=a/le>>>0,u=""+(a-le*t),t===0&&e===0)return n+u+i;for(c="",h=6-u.length,l=0;l<h;l++)c+="0";i=c+u+i}{if(s=e%le,e=e/le>>>0,a=4294967296*s+t,t=a/le>>>0,u=""+(a-le*t),t===0&&e===0)return n+u+i;for(c="",h=6-u.length,l=0;l<h;l++)c+="0";i=c+u+i}return s=e%le,a=4294967296*s+t,u=""+a%le,n+u+i}o(nu,"readInt8");Fi.exports=nu});var Qi=L(($l,qi)=>{p();var iu=ki(),O=o(function(r,e,t,n,i){t=t||0,n=n||!1,i=i||function(b,x,I){return b*Math.pow(2,I)+x};var s=t>>3,a=o(function(b){return n?~b&255:b},"inv"),u=255,c=8-t%8;e<c&&(u=255<<8-e&255,c=e),t&&(u=u>>t%8);var h=0;t%8+e>=8&&(h=i(0,a(r[s])&u,c));for(var l=e+t>>3,f=s+1;f<l;f++)h=i(h,a(r[f]),8);var m=(e+t)%8;return m>0&&(h=i(h,a(r[l])>>8-m,m)),h},"parseBits"),Oi=o(function(r,e,t){var n=Math.pow(2,t-1)-1,i=O(r,1),s=O(r,t,1);if(s===0)return 0;var a=1,u=o(function(h,l,f){h===0&&(h=1);for(var m=1;m<=f;m++)a/=2,(l&1<<f-m)>0&&(h+=a);return h},"parsePrecisionBits"),c=O(r,e,t+1,!1,u);return s==Math.pow(2,t+1)-1?c===0?i===0?1/0:-1/0:NaN:(i===0?1:-1)*Math.pow(2,s-n)*c},"parseFloatFromBits"),su=o(function(r){return O(r,1)==1?-1*(O(r,15,1,!0)+1):O(r,15,1)},"parseInt16"),Ni=o(function(r){return O(r,1)==1?-1*(O(r,31,1,!0)+1):O(r,31,1)},"parseInt32"),au=o(function(r){return Oi(r,23,8)},"parseFloat32"),ou=o(function(r){return Oi(r,52,11)},"parseFloat64"),uu=o(function(r){var e=O(r,16,32);if(e==49152)return NaN;for(var t=Math.pow(1e4,O(r,16,16)),n=0,i=[],s=O(r,16),a=0;a<s;a++)n+=O(r,16,64+16*a)*t,t/=1e4;var u=Math.pow(10,O(r,16,48));return(e===0?1:-1)*Math.round(n*u)/u},"parseNumeric"),Di=o(function(r,e){var t=O(e,1),n=O(e,63,1),i=new Date((t===0?1:-1)*n/1e3+9466848e5);return r||i.setTime(i.getTime()+i.getTimezoneOffset()*6e4),i.usec=n%1e3,i.getMicroSeconds=function(){return this.usec},i.setMicroSeconds=function(s){this.usec=s},i.getUTCMicroSeconds=function(){return this.usec},i},"parseDate"),ct=o(function(r){for(var e=O(r,32),t=O(r,32,32),n=O(r,32,64),i=96,s=[],a=0;a<e;a++)s[a]=O(r,32,i),i+=32,i+=32;var u=o(function(h){var l=O(r,32,i);if(i+=32,l==4294967295)return null;var f;if(h==23||h==20)return f=O(r,l*8,i),i+=l*8,f;if(h==25)return f=r.toString(this.encoding,i>>3,(i+=l<<3)>>3),f;console.log("ERROR: ElementType not implemented: "+h)},"parseElement"),c=o(function(h,l){var f=[],m;if(h.length>1){var b=h.shift();for(m=0;m<b;m++)f[m]=c(h,l);h.unshift(b)}else for(m=0;m<h[0];m++)f[m]=u(l);return f},"parse");return c(s,n)},"parseArray"),cu=o(function(r){return r.toString("utf8")},"parseText"),hu=o(function(r){return r===null?null:O(r,8)>0},"parseBool"),lu=o(function(r){r(20,iu),r(21,su),r(23,Ni),r(26,Ni),r(1700,uu),r(700,au),r(701,ou),r(16,hu),r(1114,Di.bind(null,!1)),r(1184,Di.bind(null,!0)),r(1e3,ct),r(1007,ct),r(1016,ct),r(1008,ct),r(1009,ct),r(25,cu)},"init");qi.exports={init:lu}});var ji=L((Vl,Hi)=>{p();Hi.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var ft=L(lt=>{p();var fu=Mi(),du=Qi(),pu=Dr(),yu=ji();lt.getTypeParser=wu;lt.setTypeParser=mu;lt.arrayParser=pu;lt.builtins=yu;var ht={text:{},binary:{}};function Ki(r){return String(r)}o(Ki,"noParse");function wu(r,e){return e=e||"text",ht[e]&&ht[e][r]||Ki}o(wu,"getTypeParser");function mu(r,e,t){typeof e=="function"&&(t=e,e="text"),ht[e][r]=t}o(mu,"setTypeParser");fu.init(function(r,e){ht.text[r]=e});du.init(function(r,e){ht.binary[r]=e})});var dt=L((Xl,Wr)=>{"use strict";p();Wr.exports={host:"localhost",user:w.platform==="win32"?w.env.USERNAME:w.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var Ve=ft(),gu=Ve.getTypeParser(20,"text"),Su=Ve.getTypeParser(1016,"text");Wr.exports.__defineSetter__("parseInt8",function(r){Ve.setTypeParser(20,"text",r?Ve.getTypeParser(23,"text"):gu),Ve.setTypeParser(1016,"text",r?Ve.getTypeParser(1007,"text"):Su)})});var pt=L((tf,Wi)=>{"use strict";p();var xu=dt();function bu(r){var e=r.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+e+'"'}o(bu,"escapeElement");function $i(r){for(var e="{",t=0;t<r.length;t++)t>0&&(e=e+","),r[t]===null||typeof r[t]>"u"?e=e+"NULL":Array.isArray(r[t])?e=e+$i(r[t]):r[t]instanceof y?e+="\\\\x"+r[t].toString("hex"):e+=bu(Ft(r[t]));return e=e+"}",e}o($i,"arrayString");var Ft=o(function(r,e){if(r==null)return null;if(r instanceof y)return r;if(ArrayBuffer.isView(r)){var t=y.from(r.buffer,r.byteOffset,r.byteLength);return t.length===r.byteLength?t:t.slice(r.byteOffset,r.byteOffset+r.byteLength)}return r instanceof Date?xu.parseInputDatesAsUTC?vu(r):Eu(r):Array.isArray(r)?$i(r):typeof r=="object"?Au(r,e):r.toString()},"prepareValue");function Au(r,e){if(r&&typeof r.toPostgres=="function"){if(e=e||[],e.indexOf(r)!==-1)throw new Error('circular reference detected while preparing "'+r+'" for query');return e.push(r),Ft(r.toPostgres(Ft),e)}return JSON.stringify(r)}o(Au,"prepareObject");function re(r,e){for(r=""+r;r.length<e;)r="0"+r;return r}o(re,"pad");function Eu(r){var e=-r.getTimezoneOffset(),t=r.getFullYear(),n=t<1;n&&(t=Math.abs(t)+1);var i=re(t,4)+"-"+re(r.getMonth()+1,2)+"-"+re(r.getDate(),2)+"T"+re(r.getHours(),2)+":"+re(r.getMinutes(),2)+":"+re(r.getSeconds(),2)+"."+re(r.getMilliseconds(),3);return e<0?(i+="-",e*=-1):i+="+",i+=re(Math.floor(e/60),2)+":"+re(e%60,2),n&&(i+=" BC"),i}o(Eu,"dateToString");function vu(r){var e=r.getUTCFullYear(),t=e<1;t&&(e=Math.abs(e)+1);var n=re(e,4)+"-"+re(r.getUTCMonth()+1,2)+"-"+re(r.getUTCDate(),2)+"T"+re(r.getUTCHours(),2)+":"+re(r.getUTCMinutes(),2)+":"+re(r.getUTCSeconds(),2)+"."+re(r.getUTCMilliseconds(),3);return n+="+00:00",t&&(n+=" BC"),n}o(vu,"dateToStringUTC");function _u(r,e,t){return r=typeof r=="string"?{text:r}:r,e&&(typeof e=="function"?r.callback=e:r.values=e),t&&(r.callback=t),r}o(_u,"normalizeQueryConfig");var Cu=o(function(r){return'"'+r.replace(/"/g,'""')+'"'},"escapeIdentifier"),Uu=o(function(r){for(var e=!1,t="'",n=0;n<r.length;n++){var i=r[n];i==="'"?t+=i+i:i==="\\"?(t+=i+i,e=!0):t+=i}return t+="'",e===!0&&(t=" E"+t),t},"escapeLiteral");Wi.exports={prepareValue:o(function(e){return Ft(e)},"prepareValueWrapper"),normalizeQueryConfig:_u,escapeIdentifier:Cu,escapeLiteral:Uu}});function yt(r){let e=1779033703,t=3144134277,n=1013904242,i=2773480762,s=1359893119,a=2600822924,u=528734635,c=1541459225,h=0,l=0,f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],m=o((U,A)=>U>>>A|U<<32-A,"rrot"),b=new Uint32Array(64),x=new Uint8Array(64),I=o(()=>{for(let P=0,M=0;P<16;P++,M+=4)b[P]=x[M]<<24|x[M+1]<<16|x[M+2]<<8|x[M+3];for(let P=16;P<64;P++){let M=m(b[P-15],7)^m(b[P-15],18)^b[P-15]>>>3,N=m(b[P-2],17)^m(b[P-2],19)^b[P-2]>>>10;b[P]=b[P-16]+M+b[P-7]+N|0}let U=e,A=t,Z=n,ae=i,j=s,V=a,k=u,ye=c;for(let P=0;P<64;P++){let M=m(j,6)^m(j,11)^m(j,25),N=j&V^~j&k,Q=ye+M+N+f[P]+b[P]|0,$=m(U,2)^m(U,13)^m(U,22),W=U&A^U&Z^A&Z,D=$+W|0;ye=k,k=V,V=j,j=ae+Q|0,ae=Z,Z=A,A=U,U=Q+D|0}e=e+U|0,t=t+A|0,n=n+Z|0,i=i+ae|0,s=s+j|0,a=a+V|0,u=u+k|0,c=c+ye|0,l=0},"process"),T=o(U=>{typeof U=="string"&&(U=new TextEncoder().encode(U));for(let A=0;A<U.length;A++)x[l++]=U[A],l===64&&I();h+=U.length},"add"),B=o(()=>{if(x[l++]=128,l==64&&I(),l+8>64){for(;l<64;)x[l++]=0;I()}for(;l<58;)x[l++]=0;let U=h*8;x[l++]=U/1099511627776&255,x[l++]=U/4294967296&255,x[l++]=U>>>24,x[l++]=U>>>16&255,x[l++]=U>>>8&255,x[l++]=U&255,I();let A=new Uint8Array(32);return A[0]=e>>>24,A[1]=e>>>16&255,A[2]=e>>>8&255,A[3]=e&255,A[4]=t>>>24,A[5]=t>>>16&255,A[6]=t>>>8&255,A[7]=t&255,A[8]=n>>>24,A[9]=n>>>16&255,A[10]=n>>>8&255,A[11]=n&255,A[12]=i>>>24,A[13]=i>>>16&255,A[14]=i>>>8&255,A[15]=i&255,A[16]=s>>>24,A[17]=s>>>16&255,A[18]=s>>>8&255,A[19]=s&255,A[20]=a>>>24,A[21]=a>>>16&255,A[22]=a>>>8&255,A[23]=a&255,A[24]=u>>>24,A[25]=u>>>16&255,A[26]=u>>>8&255,A[27]=u&255,A[28]=c>>>24,A[29]=c>>>16&255,A[30]=c>>>8&255,A[31]=c&255,A},"digest");return r===void 0?{add:T,digest:B}:(T(r),B())}var Gi=ee(()=>{"use strict";p();o(yt,"sha256")});var fe,Ae,Vi=ee(()=>{"use strict";p();fe=class{constructor(){S(this,"_dataLength",0);S(this,"_bufferLength",0);S(this,"_state",new Int32Array(4));S(this,"_buffer",new ArrayBuffer(68));S(this,"_buffer8");S(this,"_buffer32");this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,t=!1){return this.onePassHasher.start().appendByteArray(e).end(t)}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){let t=fe.hexChars,n=fe.hexOut,i,s,a,u;for(u=0;u<4;u+=1)for(s=u*8,i=e[u],a=0;a<8;a+=2)n[s+1+a]=t.charAt(i&15),i>>>=4,n[s+0+a]=t.charAt(i&15),i>>>=4;return n.join("")}static _md5cycle(e,t){let n=e[0],i=e[1],s=e[2],a=e[3];n+=(i&s|~i&a)+t[0]-680876936|0,n=(n<<7|n>>>25)+i|0,a+=(n&i|~n&s)+t[1]-389564586|0,a=(a<<12|a>>>20)+n|0,s+=(a&n|~a&i)+t[2]+606105819|0,s=(s<<17|s>>>15)+a|0,i+=(s&a|~s&n)+t[3]-1044525330|0,i=(i<<22|i>>>10)+s|0,n+=(i&s|~i&a)+t[4]-176418897|0,n=(n<<7|n>>>25)+i|0,a+=(n&i|~n&s)+t[5]+1200080426|0,a=(a<<12|a>>>20)+n|0,s+=(a&n|~a&i)+t[6]-1473231341|0,s=(s<<17|s>>>15)+a|0,i+=(s&a|~s&n)+t[7]-45705983|0,i=(i<<22|i>>>10)+s|0,n+=(i&s|~i&a)+t[8]+1770035416|0,n=(n<<7|n>>>25)+i|0,a+=(n&i|~n&s)+t[9]-1958414417|0,a=(a<<12|a>>>20)+n|0,s+=(a&n|~a&i)+t[10]-42063|0,s=(s<<17|s>>>15)+a|0,i+=(s&a|~s&n)+t[11]-1990404162|0,i=(i<<22|i>>>10)+s|0,n+=(i&s|~i&a)+t[12]+1804603682|0,n=(n<<7|n>>>25)+i|0,a+=(n&i|~n&s)+t[13]-40341101|0,a=(a<<12|a>>>20)+n|0,s+=(a&n|~a&i)+t[14]-1502002290|0,s=(s<<17|s>>>15)+a|0,i+=(s&a|~s&n)+t[15]+1236535329|0,i=(i<<22|i>>>10)+s|0,n+=(i&a|s&~a)+t[1]-165796510|0,n=(n<<5|n>>>27)+i|0,a+=(n&s|i&~s)+t[6]-1069501632|0,a=(a<<9|a>>>23)+n|0,s+=(a&i|n&~i)+t[11]+643717713|0,s=(s<<14|s>>>18)+a|0,i+=(s&n|a&~n)+t[0]-373897302|0,i=(i<<20|i>>>12)+s|0,n+=(i&a|s&~a)+t[5]-701558691|0,n=(n<<5|n>>>27)+i|0,a+=(n&s|i&~s)+t[10]+38016083|0,a=(a<<9|a>>>23)+n|0,s+=(a&i|n&~i)+t[15]-660478335|0,s=(s<<14|s>>>18)+a|0,i+=(s&n|a&~n)+t[4]-405537848|0,i=(i<<20|i>>>12)+s|0,n+=(i&a|s&~a)+t[9]+568446438|0,n=(n<<5|n>>>27)+i|0,a+=(n&s|i&~s)+t[14]-1019803690|0,a=(a<<9|a>>>23)+n|0,s+=(a&i|n&~i)+t[3]-187363961|0,s=(s<<14|s>>>18)+a|0,i+=(s&n|a&~n)+t[8]+1163531501|0,i=(i<<20|i>>>12)+s|0,n+=(i&a|s&~a)+t[13]-1444681467|0,n=(n<<5|n>>>27)+i|0,a+=(n&s|i&~s)+t[2]-51403784|0,a=(a<<9|a>>>23)+n|0,s+=(a&i|n&~i)+t[7]+1735328473|0,s=(s<<14|s>>>18)+a|0,i+=(s&n|a&~n)+t[12]-1926607734|0,i=(i<<20|i>>>12)+s|0,n+=(i^s^a)+t[5]-378558|0,n=(n<<4|n>>>28)+i|0,a+=(n^i^s)+t[8]-2022574463|0,a=(a<<11|a>>>21)+n|0,s+=(a^n^i)+t[11]+1839030562|0,s=(s<<16|s>>>16)+a|0,i+=(s^a^n)+t[14]-35309556|0,i=(i<<23|i>>>9)+s|0,n+=(i^s^a)+t[1]-1530992060|0,n=(n<<4|n>>>28)+i|0,a+=(n^i^s)+t[4]+1272893353|0,a=(a<<11|a>>>21)+n|0,s+=(a^n^i)+t[7]-155497632|0,s=(s<<16|s>>>16)+a|0,i+=(s^a^n)+t[10]-1094730640|0,i=(i<<23|i>>>9)+s|0,n+=(i^s^a)+t[13]+681279174|0,n=(n<<4|n>>>28)+i|0,a+=(n^i^s)+t[0]-358537222|0,a=(a<<11|a>>>21)+n|0,s+=(a^n^i)+t[3]-722521979|0,s=(s<<16|s>>>16)+a|0,i+=(s^a^n)+t[6]+76029189|0,i=(i<<23|i>>>9)+s|0,n+=(i^s^a)+t[9]-640364487|0,n=(n<<4|n>>>28)+i|0,a+=(n^i^s)+t[12]-421815835|0,a=(a<<11|a>>>21)+n|0,s+=(a^n^i)+t[15]+530742520|0,s=(s<<16|s>>>16)+a|0,i+=(s^a^n)+t[2]-995338651|0,i=(i<<23|i>>>9)+s|0,n+=(s^(i|~a))+t[0]-198630844|0,n=(n<<6|n>>>26)+i|0,a+=(i^(n|~s))+t[7]+1126891415|0,a=(a<<10|a>>>22)+n|0,s+=(n^(a|~i))+t[14]-1416354905|0,s=(s<<15|s>>>17)+a|0,i+=(a^(s|~n))+t[5]-57434055|0,i=(i<<21|i>>>11)+s|0,n+=(s^(i|~a))+t[12]+1700485571|0,n=(n<<6|n>>>26)+i|0,a+=(i^(n|~s))+t[3]-1894986606|0,a=(a<<10|a>>>22)+n|0,s+=(n^(a|~i))+t[10]-1051523|0,s=(s<<15|s>>>17)+a|0,i+=(a^(s|~n))+t[1]-2054922799|0,i=(i<<21|i>>>11)+s|0,n+=(s^(i|~a))+t[8]+1873313359|0,n=(n<<6|n>>>26)+i|0,a+=(i^(n|~s))+t[15]-30611744|0,a=(a<<10|a>>>22)+n|0,s+=(n^(a|~i))+t[6]-1560198380|0,s=(s<<15|s>>>17)+a|0,i+=(a^(s|~n))+t[13]+1309151649|0,i=(i<<21|i>>>11)+s|0,n+=(s^(i|~a))+t[4]-145523070|0,n=(n<<6|n>>>26)+i|0,a+=(i^(n|~s))+t[11]-1120210379|0,a=(a<<10|a>>>22)+n|0,s+=(n^(a|~i))+t[2]+718787259|0,s=(s<<15|s>>>17)+a|0,i+=(a^(s|~n))+t[9]-343485551|0,i=(i<<21|i>>>11)+s|0,e[0]=n+e[0]|0,e[1]=i+e[1]|0,e[2]=s+e[2]|0,e[3]=a+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(fe.stateIdentity),this}appendStr(e){let t=this._buffer8,n=this._buffer32,i=this._bufferLength,s,a;for(a=0;a<e.length;a+=1){if(s=e.charCodeAt(a),s<128)t[i++]=s;else if(s<2048)t[i++]=(s>>>6)+192,t[i++]=s&63|128;else if(s<55296||s>56319)t[i++]=(s>>>12)+224,t[i++]=s>>>6&63|128,t[i++]=s&63|128;else{if(s=(s-55296)*1024+(e.charCodeAt(++a)-56320)+65536,s>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[i++]=(s>>>18)+240,t[i++]=s>>>12&63|128,t[i++]=s>>>6&63|128,t[i++]=s&63|128}i>=64&&(this._dataLength+=64,fe._md5cycle(this._state,n),i-=64,n[0]=n[16])}return this._bufferLength=i,this}appendAsciiStr(e){let t=this._buffer8,n=this._buffer32,i=this._bufferLength,s,a=0;for(;;){for(s=Math.min(e.length-a,64-i);s--;)t[i++]=e.charCodeAt(a++);if(i<64)break;this._dataLength+=64,fe._md5cycle(this._state,n),i=0}return this._bufferLength=i,this}appendByteArray(e){let t=this._buffer8,n=this._buffer32,i=this._bufferLength,s,a=0;for(;;){for(s=Math.min(e.length-a,64-i);s--;)t[i++]=e[a++];if(i<64)break;this._dataLength+=64,fe._md5cycle(this._state,n),i=0}return this._bufferLength=i,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t=e.buffer,n=e.state,i=this._state,s;for(this._dataLength=e.length,this._bufferLength=e.buflen,i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],s=0;s<t.length;s+=1)this._buffer8[s]=t.charCodeAt(s)}end(e=!1){let t=this._bufferLength,n=this._buffer8,i=this._buffer32,s=(t>>2)+1;this._dataLength+=t;let a=this._dataLength*8;if(n[t]=128,n[t+1]=n[t+2]=n[t+3]=0,i.set(fe.buffer32Identity.subarray(s),s),t>55&&(fe._md5cycle(this._state,i),i.set(fe.buffer32Identity)),a<=4294967295)i[14]=a;else{let u=a.toString(16).match(/(.*?)(.{0,8})$/);if(u===null)return;let c=parseInt(u[2],16),h=parseInt(u[1],16)||0;i[14]=c,i[15]=h}return fe._md5cycle(this._state,i),e?this._state:fe._hex(this._state)}},Ae=fe;o(Ae,"Md5"),S(Ae,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),S(Ae,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),S(Ae,"hexChars","0123456789abcdef"),S(Ae,"hexOut",[]),S(Ae,"onePassHasher",new fe)});var Gr={};we(Gr,{createHash:()=>Lu,createHmac:()=>Tu,randomBytes:()=>Iu});function Iu(r){return g.getRandomValues(y.alloc(r))}function Lu(r){if(r==="sha256")return{update:function(e){return{digest:function(){return y.from(yt(e))}}}};if(r==="md5")return{update:function(e){return{digest:function(){return typeof e=="string"?Ae.hashStr(e):Ae.hashByteArray(e)}}}};throw new Error(`Hash type '${r}' not supported`)}function Tu(r,e){if(r!=="sha256")throw new Error(`Only sha256 is supported (requested: '${r}')`);return{update:function(t){return{digest:function(){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));let n=e.length;if(n>64)e=yt(e);else if(n<64){let c=new Uint8Array(64);c.set(e),e=c}let i=new Uint8Array(64),s=new Uint8Array(64);for(let c=0;c<64;c++)i[c]=54^e[c],s[c]=92^e[c];let a=new Uint8Array(t.length+64);a.set(i,0),a.set(t,64);let u=new Uint8Array(64+32);return u.set(s,0),u.set(yt(a),64),y.from(yt(u))}}}}}var Vr=ee(()=>{p();Gi();Vi();o(Iu,"randomBytes");o(Lu,"createHash");o(Tu,"createHmac")});var Ji=L((yf,zi)=>{"use strict";p();var wt=(Vr(),K(Gr));function zr(r){return wt.createHash("md5").update(r,"utf-8").digest("hex")}o(zr,"md5");function Bu(r,e,t){var n=zr(e+r),i=zr(y.concat([y.from(n),t]));return"md5"+i}o(Bu,"postgresMd5PasswordHash");function Pu(r){return wt.createHash("sha256").update(r).digest()}o(Pu,"sha256");function Ru(r,e){return wt.createHmac("sha256",r).update(e).digest()}o(Ru,"hmacSha256");async function Mu(r,e,t){return wt.pbkdf2Sync(r,e,t,32,"sha256")}o(Mu,"deriveKey");zi.exports={postgresMd5PasswordHash:Bu,randomBytes:wt.randomBytes,deriveKey:Mu,sha256:Pu,hmacSha256:Ru,md5:zr}});var Xr=L((gf,Zr)=>{"use strict";p();var Fu=parseInt(w.versions&&w.versions.node&&w.versions.node.split(".")[0])<15;if(Fu){Zr.exports=Ji();return}var Yi=(Vr(),K(Gr));Zr.exports={postgresMd5PasswordHash:Nu,randomBytes:ku,deriveKey:qu,sha256:Du,hmacSha256:Ou,md5:Jr};var Zi=Yi.webcrypto||globalThis.crypto,ze=Zi.subtle,Yr=new TextEncoder;function ku(r){return Zi.getRandomValues(y.alloc(r))}o(ku,"randomBytes");async function Jr(r){try{return Yi.createHash("md5").update(r,"utf-8").digest("hex")}catch{let t=typeof r=="string"?Yr.encode(r):r,n=await ze.digest("MD5",t);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}}o(Jr,"md5");async function Nu(r,e,t){var n=await Jr(e+r),i=await Jr(y.concat([y.from(n),t]));return"md5"+i}o(Nu,"postgresMd5PasswordHash");async function Du(r){return await ze.digest("SHA-256",r)}o(Du,"sha256");async function Ou(r,e){let t=await ze.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await ze.sign("HMAC",t,Yr.encode(e))}o(Ou,"hmacSha256");async function qu(r,e,t){let n=await ze.importKey("raw",Yr.encode(r),"PBKDF2",!1,["deriveBits"]),i={name:"PBKDF2",hash:"SHA-256",salt:e,iterations:t};return await ze.deriveBits(i,n,32*8,["deriveBits"])}o(qu,"deriveKey")});var rs=L((bf,ts)=>{"use strict";p();var ke=Xr();function Qu(r){if(r.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let e=ke.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:e,response:"n,,n=*,r="+e,message:"SASLInitialResponse"}}o(Qu,"startSession");async function Hu(r,e,t){if(r.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(e==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof t!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let n=$u(t);if(n.nonce.startsWith(r.clientNonce)){if(n.nonce.length===r.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var i="n=*,r="+r.clientNonce,s="r="+n.nonce+",s="+n.salt+",i="+n.iteration,a="c=biws,r="+n.nonce,u=i+","+s+","+a,c=y.from(n.salt,"base64"),h=await ke.deriveKey(e,c,n.iteration),l=await ke.hmacSha256(h,"Client Key"),f=await ke.sha256(l),m=await ke.hmacSha256(f,u),b=Gu(y.from(l),y.from(m)).toString("base64"),x=await ke.hmacSha256(h,"Server Key"),I=await ke.hmacSha256(x,u);r.message="SASLResponse",r.serverSignature=y.from(I).toString("base64"),r.response=a+",p="+b}o(Hu,"continueSession");function ju(r,e){if(r.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:t}=Wu(e);if(t!==r.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}o(ju,"finalizeSession");function Ku(r){if(typeof r!="string")throw new TypeError("SASL: text must be a string");return r.split("").map((e,t)=>r.charCodeAt(t)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}o(Ku,"isPrintableChars");function Xi(r){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(r)}o(Xi,"isBase64");function es(r){if(typeof r!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(r.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let t=e[0],n=e.substring(2);return[t,n]}))}o(es,"parseAttributePairs");function $u(r){let e=es(r),t=e.get("r");if(t){if(!Ku(t))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let n=e.get("s");if(n){if(!Xi(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let i=e.get("i");if(i){if(!/^[1-9][0-9]*$/.test(i))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let s=parseInt(i,10);return{nonce:t,salt:n,iteration:s}}o($u,"parseServerFirstMessage");function Wu(r){let t=es(r).get("v");if(t){if(!Xi(t))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:t}}o(Wu,"parseServerFinalMessage");function Gu(r,e){if(!y.isBuffer(r))throw new TypeError("first argument must be a Buffer");if(!y.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(r.length!==e.length)throw new Error("Buffer lengths must match");if(r.length===0)throw new Error("Buffers cannot be empty");return y.from(r.map((t,n)=>r[n]^e[n]))}o(Gu,"xorBuffers");ts.exports={startSession:Qu,continueSession:Hu,finalizeSession:ju}});var en=L((vf,ns)=>{"use strict";p();var Vu=ft();function kt(r){this._types=r||Vu,this.text={},this.binary={}}o(kt,"TypeOverrides");kt.prototype.getOverrides=function(r){switch(r){case"text":return this.text;case"binary":return this.binary;default:return{}}};kt.prototype.setTypeParser=function(r,e,t){typeof e=="function"&&(t=e,e="text"),this.getOverrides(e)[r]=t};kt.prototype.getTypeParser=function(r,e){return e=e||"text",this.getOverrides(e)[r]||this._types.getTypeParser(r,e)};ns.exports=kt});var is={};we(is,{default:()=>zu});var zu,ss=ee(()=>{p();zu={}});var tn={};we(tn,{stat:()=>Ju});function Ju(r,e){e(new Error("No filesystem"))}var rn=ee(()=>{p();o(Ju,"stat")});var os=L((Tf,as)=>{"use strict";p();function nn(r){if(r.charAt(0)==="/"){let u=r.split(" ");return{host:u[0],database:u[1]}}let e={},t,n=!1;/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(r)&&(r=encodeURI(r).replace(/\%25(\d\d)/g,"%$1"));try{t=new URL(r,"postgres://base")}catch{t=new URL(r.replace("@/","@___DUMMY___/"),"postgres://base"),n=!0}for(let u of t.searchParams.entries())e[u[0]]=u[1];if(e.user=e.user||decodeURIComponent(t.username),e.password=e.password||decodeURIComponent(t.password),e.port=t.port,t.protocol=="socket:")return e.host=decodeURI(t.pathname),e.database=t.searchParams.get("db"),e.client_encoding=t.searchParams.get("encoding"),e;let i=n?"":t.hostname;e.host?i&&(t.pathname=i+t.pathname):e.host=decodeURIComponent(i);let s=t.pathname.slice(1)||null;e.database=s?decodeURI(s):null,(e.ssl==="true"||e.ssl==="1")&&(e.ssl=!0),e.ssl==="0"&&(e.ssl=!1),(e.sslcert||e.sslkey||e.sslrootcert||e.sslmode)&&(e.ssl={});let a=e.sslcert||e.sslkey||e.sslrootcert?(rn(),K(tn)):null;switch(e.sslcert&&(e.ssl.cert=a.readFileSync(e.sslcert).toString()),e.sslkey&&(e.ssl.key=a.readFileSync(e.sslkey).toString()),e.sslrootcert&&(e.ssl.ca=a.readFileSync(e.sslrootcert).toString()),e.sslmode){case"disable":{e.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{e.ssl.rejectUnauthorized=!1;break}}return e}o(nn,"parse");as.exports=nn;nn.parse=nn});var sn=L((Rf,hs)=>{"use strict";p();var Yu=(ss(),K(is)),cs=dt(),us=os().parse,ue=o(function(r,e,t){return t===void 0?t=w.env["PG"+r.toUpperCase()]:t===!1||(t=w.env[t]),e[r]||t||cs[r]},"val"),Zu=o(function(){switch(w.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return cs.ssl},"readSSLConfigFromEnvironment"),Je=o(function(r){return"'"+(""+r).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),xe=o(function(r,e,t){var n=e[t];n!=null&&r.push(t+"="+Je(n))},"add"),Nt=class{constructor(e){e=typeof e=="string"?us(e):e||{},e.connectionString&&(e=Object.assign({},e,us(e.connectionString))),this.user=ue("user",e),this.database=ue("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(ue("port",e),10),this.host=ue("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:ue("password",e)}),this.binary=ue("binary",e),this.options=ue("options",e),this.ssl=typeof e.ssl>"u"?Zu():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=ue("client_encoding",e),this.replication=ue("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=ue("application_name",e,"PGAPPNAME"),this.fallback_application_name=ue("fallback_application_name",e,!1),this.statement_timeout=ue("statement_timeout",e,!1),this.lock_timeout=ue("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=ue("idle_in_transaction_session_timeout",e,!1),this.query_timeout=ue("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=w.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var t=[];xe(t,this,"user"),xe(t,this,"password"),xe(t,this,"port"),xe(t,this,"application_name"),xe(t,this,"fallback_application_name"),xe(t,this,"connect_timeout"),xe(t,this,"options");var n=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(xe(t,n,"sslmode"),xe(t,n,"sslca"),xe(t,n,"sslkey"),xe(t,n,"sslcert"),xe(t,n,"sslrootcert"),this.database&&t.push("dbname="+Je(this.database)),this.replication&&t.push("replication="+Je(this.replication)),this.host&&t.push("host="+Je(this.host)),this.isDomainSocket)return e(null,t.join(" "));this.client_encoding&&t.push("client_encoding="+Je(this.client_encoding)),Yu.lookup(this.host,function(i,s){return i?e(i,null):(t.push("hostaddr="+Je(s)),e(null,t.join(" ")))})}};o(Nt,"ConnectionParameters");hs.exports=Nt});var ds=L((kf,fs)=>{"use strict";p();var Xu=ft(),ls=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,Dt=class{constructor(e,t){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=t,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(e){var t;e.text?t=ls.exec(e.text):t=ls.exec(e.command),t&&(this.command=t[1],t[3]?(this.oid=parseInt(t[2],10),this.rowCount=parseInt(t[3],10)):t[2]&&(this.rowCount=parseInt(t[2],10)))}_parseRowAsArray(e){for(var t=new Array(e.length),n=0,i=e.length;n<i;n++){var s=e[n];s!==null?t[n]=this._parsers[n](s):t[n]=null}return t}parseRow(e){for(var t={},n=0,i=e.length;n<i;n++){var s=e[n],a=this.fields[n].name;s!==null?t[a]=this._parsers[n](s):t[a]=null}return t}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var t=0;t<e.length;t++){var n=e[t];this._types?this._parsers[t]=this._types.getTypeParser(n.dataTypeID,n.format||"text"):this._parsers[t]=Xu.getTypeParser(n.dataTypeID,n.format||"text")}}};o(Dt,"Result");fs.exports=Dt});var ms=L((Of,ws)=>{"use strict";p();var{EventEmitter:ec}=Ie(),ps=ds(),ys=pt(),Ot=class extends ec{constructor(e,t,n){super(),e=ys.normalizeQueryConfig(e,t,n),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,w.domain&&e.callback&&(this.callback=w.domain.bind(e.callback)),this._result=new ps(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new ps(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let t;if(!this._canceledDueToError){try{t=this._result.parseRow(e.fields)}catch(n){this._canceledDueToError=n;return}this.emit("row",t,this._result),this._accumulateRows&&this._result.addRow(t)}}handleCommandComplete(e,t){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&t.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,t){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(t){w.nextTick(()=>{throw t})}this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let t=e.parsedStatements[this.name];return this.text&&t&&this.text!==t?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,t){e.execute({portal:this.portal,rows:t}),t?e.flush():e.sync()}prepare(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:ys.prepareValue})}catch(t){this.handleError(t,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,t){}};o(Ot,"Query");ws.exports=Ot});function ie(...r){if(r.length===1&&r[0]instanceof Uint8Array)return r[0];let e=r.reduce((i,s)=>i+s.length,0),t=new Uint8Array(e),n=0;for(let i of r)t.set(i,n),n+=i.length;return t}function St(r,e){let t=r.length;if(t!==e.length)return!1;for(let n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}function rc(r,e,t,n=!0){let i=new _e(1024);i.writeUint8(22,0),i.writeUint16(769,0);let s=i.writeLengthUint16();i.writeUint8(1,0);let a=i.writeLengthUint24();i.writeUint16(771,0),g.getRandomValues(i.subarray(32));let u=i.writeLengthUint8(0);i.writeBytes(t),u();let c=i.writeLengthUint16(0);i.writeUint16(4865,0),c();let h=i.writeLengthUint8(0);i.writeUint8(0,0),h();let l=i.writeLengthUint16(0);if(n){i.writeUint16(0,0);let j=i.writeLengthUint16(0),V=i.writeLengthUint16(0);i.writeUint8(0,0);let k=i.writeLengthUint16(0);i.writeUTF8String(r),k(),V(),j()}i.writeUint16(11,0);let f=i.writeLengthUint16(0),m=i.writeLengthUint8(0);i.writeUint8(0,0),m(),f(),i.writeUint16(10,0);let b=i.writeLengthUint16(0),x=i.writeLengthUint16(0);i.writeUint16(23,0),x(),b(),i.writeUint16(13,0);let I=i.writeLengthUint16(0),T=i.writeLengthUint16(0);i.writeUint16(1027,0),i.writeUint16(2052,0),T(),I(),i.writeUint16(43,0);let B=i.writeLengthUint16(0),U=i.writeLengthUint8(0);i.writeUint16(772,0),U(),B(),i.writeUint16(51,0);let A=i.writeLengthUint16(0),Z=i.writeLengthUint16(0);i.writeUint16(23,0);let ae=i.writeLengthUint16(0);return i.writeBytes(new Uint8Array(e)),ae(),Z(),A(),l(),a(),s(),i}function Be(r,e=""){return[...r].map(t=>t.toString(16).padStart(2,"0")).join(e)}function nc(r,e){let t,n,[i]=r.expectLength(r.remaining());r.expectUint8(2,0);let[s]=r.expectLengthUint24(0);r.expectUint16(771,0);let a=r.readBytes(32);if(St(a,[207,33,173,116,229,154,97,17,190,29,140,2,30,101,184,145,194,162,17,22,122,187,140,94,7,158,9,226,200,168,51,156]))throw new Error("Unexpected HelloRetryRequest");r.expectUint8(e.length,0),r.expectBytes(e,0),r.expectUint16(4865,0),r.expectUint8(0,0);let[u,c]=r.expectLengthUint16(0);for(;c()>0;){let h=r.readUint16(0),[l]=r.expectLengthUint16(0);if(h===43)r.expectUint16(772,0),n=!0;else if(h===51)r.expectUint16(23,0),r.expectUint16(65),t=r.readBytes(65);else throw new Error(`Unexpected extension 0x${Be([h])}`);l()}if(u(),s(),i(),n!==!0)throw new Error("No TLS version provided");if(t===void 0)throw new Error("No key provided");return t}async function hn(r,e,t=mt){let n=await r(5);if(n===void 0)return;if(n.length<5)throw new Error("TLS record header truncated");let i=new _e(n),s=i.readUint8();if(s<20||s>24)throw new Error(`Illegal TLS record type 0x${s.toString(16)}`);if(e!==void 0&&s!==e)throw new Error(`Unexpected TLS record type 0x${s.toString(16).padStart(2,"0")} (expected 0x${e.toString(16).padStart(2,"0")})`);i.expectUint16(771,"TLS record version 1.2 (middlebox compatibility)");let a=i.readUint16(0);if(a>t)throw new Error(`Record too long: ${a} bytes`);let u=await r(a);if(u===void 0||u.length<a)throw new Error("TLS record content truncated");return{headerData:n,header:i,type:s,length:a,content:u}}async function ln(r,e,t){let n=await hn(r,23,ic);if(n===void 0)return;let i=new _e(n.content),[s]=i.expectLength(i.remaining());i.skip(n.length-16,0),i.skip(16,0),s();let a=await e.process(n.content,16,n.headerData),u=a.length-1;for(;a[u]===0;)u-=1;if(u<0)throw new Error("Decrypted message has no record type indicator (all zeroes)");let c=a[u],h=a.subarray(0,u);if(!(c===21&&h.length===2&&h[0]===1&&h[1]===0)){if(c===22&&h[0]===4)return ln(r,e,t);if(t!==void 0&&c!==t)throw new Error(`Unexpected TLS record type 0x${c.toString(16).padStart(2,"0")} (expected 0x${t.toString(16).padStart(2,"0")})`);return h}}async function sc(r,e,t){let n=ie(r,[t]),i=5,s=n.length+16,a=new _e(i+s);a.writeUint8(23,0),a.writeUint16(771,0),a.writeUint16(s,`${s} bytes follow`);let[u]=a.expectLength(s),c=a.array(),h=await e.process(n,16,c);return a.writeBytes(h.subarray(0,h.length-16)),a.writeBytes(h.subarray(h.length-16)),u(),a.array()}async function Ss(r,e,t){let n=Math.ceil(r.length/mt),i=[];for(let s=0;s<n;s++){let a=r.subarray(s*mt,(s+1)*mt),u=await sc(a,e,t);i.push(u)}return i}async function fn(r,e,t){let n=await R.importKey("raw",r,{name:"HMAC",hash:{name:`SHA-${t}`}},!1,["sign"]);var i=new Uint8Array(await R.sign("HMAC",n,e));return i}async function ac(r,e,t,n){let i=n>>3,s=Math.ceil(t/i),a=new Uint8Array(s*i),u=await R.importKey("raw",r,{name:"HMAC",hash:{name:`SHA-${n}`}},!1,["sign"]),c=new Uint8Array(0);for(let h=0;h<s;h++){let l=ie(c,e,[h+1]),f=await R.sign("HMAC",u,l),m=new Uint8Array(f);a.set(m,i*h),c=m}return a.subarray(0,t)}async function se(r,e,t,n,i){let s=vs.encode(e),a=ie([(n&65280)>>8,n&255],[xs.length+s.length],xs,s,[t.length],t);return ac(r,a,n,i)}async function oc(r,e,t,n,i){let s=n>>>3,a=new Uint8Array(s),u=await R.importKey("raw",r,{name:"ECDH",namedCurve:"P-256"},!1,[]),c=await R.deriveBits({name:"ECDH",public:u},e,256),h=new Uint8Array(c),l=await R.digest("SHA-256",t),f=new Uint8Array(l),m=await fn(new Uint8Array(1),a,n),b=await R.digest(`SHA-${n}`,new Uint8Array(0)),x=new Uint8Array(b),I=await se(m,"derived",x,s,n),T=await fn(I,h,n),B=await se(T,"c hs traffic",f,s,n),U=await se(T,"s hs traffic",f,s,n),A=await se(B,"key",new Uint8Array(0),i,n),Z=await se(U,"key",new Uint8Array(0),i,n),ae=await se(B,"iv",new Uint8Array(0),12,n),j=await se(U,"iv",new Uint8Array(0),12,n);return{serverHandshakeKey:Z,serverHandshakeIV:j,clientHandshakeKey:A,clientHandshakeIV:ae,handshakeSecret:T,clientSecret:B,serverSecret:U}}async function uc(r,e,t,n){let i=t>>>3,s=new Uint8Array(i),a=await R.digest(`SHA-${t}`,new Uint8Array(0)),u=new Uint8Array(a),c=await se(r,"derived",u,i,t),h=await fn(c,s,t),l=await se(h,"c ap traffic",e,i,t),f=await se(h,"s ap traffic",e,i,t),m=await se(l,"key",new Uint8Array(0),n,t),b=await se(f,"key",new Uint8Array(0),n,t),x=await se(l,"iv",new Uint8Array(0),12,t),I=await se(f,"iv",new Uint8Array(0),12,t);return{serverApplicationKey:b,serverApplicationIV:I,clientApplicationKey:m,clientApplicationIV:x}}function Qt(r){return r>64&&r<91?r-65:r>96&&r<123?r-71:r>47&&r<58?r+4:r===43?62:r===47?63:r===61?64:void 0}function hc(r){let e=r.length,t=0,n=0,i=64,s=64,a=64,u=64,c=new Uint8Array(e*.75);for(;t<e;)i=Qt(r.charCodeAt(t++)),s=Qt(r.charCodeAt(t++)),a=Qt(r.charCodeAt(t++)),u=Qt(r.charCodeAt(t++)),c[n++]=i<<2|s>>4,c[n++]=(s&15)<<4|a>>2,c[n++]=(a&3)<<6|u;let h=s===64?0:a===64?2:u===64?1:0;return c.subarray(0,n-h)}function bs(r,e=(n,i)=>i,t){return JSON.stringify(r,(n,i)=>e(n,typeof i!="object"||i===null||Array.isArray(i)?i:Object.fromEntries(Object.entries(i).sort(([s],[a])=>s<a?-1:s>a?1:0))),t)}function wc(r){let{length:e}=r;if(e>4)throw new Error(`Bit string length ${e} would overflow JS bit operators`);let t=0,n=0;for(let i=r.length-1;i>=0;i--)t|=r[i]<<n,n+=8;return t}function Es(r,e){let t={};r.expectUint8(ne,0);let[n,i]=r.expectASN1Length(0);for(;i()>0;){r.expectUint8(lc,0);let[s]=r.expectASN1Length(0);r.expectUint8(ne,0);let[a]=r.expectASN1Length(0);r.expectUint8(Ze,0);let u=r.readASN1OID(),c=yc[u]??u,h=r.readUint8();if(h!==fc&&h!==dc)throw new Error(`Unexpected item type in certificate ${e}: 0x${Be([h])}`);let[l,f]=r.expectASN1Length(0),m=r.readUTF8String(f());if(l(),a(),s(),t[c]!==void 0)throw new Error(`Duplicate OID ${c} in certificate ${e}`);t[c]=m}return n(),t}function mc(r,e=0){let t=[],[n,i]=r.expectASN1Length(0);for(;i()>0;){let s=r.readUint8(0),[a,u]=r.expectASN1Length(0),c;s===(e|2)?c=r.readUTF8String(u()):c=r.readBytes(u()),t.push({name:c,type:s}),a()}return n(),t}function gc(r){let e={"1.2.840.113549.1.1.1":{name:"RSAES-PKCS1-v1_5"},"1.2.840.113549.1.1.5":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},"1.2.840.113549.1.1.11":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},"1.2.840.113549.1.1.12":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}},"1.2.840.113549.1.1.13":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},"1.2.840.113549.1.1.10":{name:"RSA-PSS"},"1.2.840.113549.1.1.7":{name:"RSA-OAEP"},"1.2.840.10045.2.1":{name:"ECDSA",hash:{name:"SHA-1"}},"1.2.840.10045.4.1":{name:"ECDSA",hash:{name:"SHA-1"}},"1.2.840.10045.4.3.2":{name:"ECDSA",hash:{name:"SHA-256"}},"1.2.840.10045.4.3.3":{name:"ECDSA",hash:{name:"SHA-384"}},"1.2.840.10045.4.3.4":{name:"ECDSA",hash:{name:"SHA-512"}},"1.3.133.16.840.63.0.2":{name:"ECDH",kdf:"SHA-1"},"1.3.132.1.11.1":{name:"ECDH",kdf:"SHA-256"},"1.3.132.1.11.2":{name:"ECDH",kdf:"SHA-384"},"1.3.132.1.11.3":{name:"ECDH",kdf:"SHA-512"},"2.16.840.1.101.3.4.1.2":{name:"AES-CBC",length:128},"2.16.840.1.101.3.4.1.22":{name:"AES-CBC",length:192},"2.16.840.1.101.3.4.1.42":{name:"AES-CBC",length:256},"2.16.840.1.101.3.4.1.6":{name:"AES-GCM",length:128},"2.16.840.1.101.3.4.1.26":{name:"AES-GCM",length:192},"2.16.840.1.101.3.4.1.46":{name:"AES-GCM",length:256},"2.16.840.1.101.3.4.1.4":{name:"AES-CFB",length:128},"2.16.840.1.101.3.4.1.24":{name:"AES-CFB",length:192},"2.16.840.1.101.3.4.1.44":{name:"AES-CFB",length:256},"2.16.840.1.101.3.4.1.5":{name:"AES-KW",length:128},"2.16.840.1.101.3.4.1.25":{name:"AES-KW",length:192},"2.16.840.1.101.3.4.1.45":{name:"AES-KW",length:256},"1.2.840.113549.2.7":{name:"HMAC",hash:{name:"SHA-1"}},"1.2.840.113549.2.9":{name:"HMAC",hash:{name:"SHA-256"}},"1.2.840.113549.2.10":{name:"HMAC",hash:{name:"SHA-384"}},"1.2.840.113549.2.11":{name:"HMAC",hash:{name:"SHA-512"}},"1.2.840.113549.1.9.16.3.5":{name:"DH"},"1.3.14.3.2.26":{name:"SHA-1"},"2.16.840.1.101.3.4.2.1":{name:"SHA-256"},"2.16.840.1.101.3.4.2.2":{name:"SHA-384"},"2.16.840.1.101.3.4.2.3":{name:"SHA-512"},"1.2.840.113549.1.5.12":{name:"PBKDF2"},"1.2.840.10045.3.1.7":{name:"P-256"},"1.3.132.0.34":{name:"P-384"},"1.3.132.0.35":{name:"P-521"}}[r];if(e===void 0)throw new Error(`Unsupported algorithm identifier: ${r}`);return e}function _s(r,e=[]){return Object.values(r).forEach(t=>{typeof t=="string"?e=[...e,t]:e=_s(t,e)}),e}function Sc(r){return _s(r).join(" / ")}async function Cs(r,e,t,n,i){r.expectUint8(ne,0);let[s]=r.expectASN1Length(0);r.expectUint8(jt,0);let[a,u]=r.expectASN1Length(0),c=r.readBytes(u());a(),r.expectUint8(jt,0);let[h,l]=r.expectASN1Length(0),f=r.readBytes(l());h(),s();let m=o((T,B)=>T.length>B?T.subarray(T.length-B):T.length<B?ie(new Uint8Array(B-T.length),T):T,"g"),b=n==="P-256"?32:48,x=ie(m(c,b),m(f,b)),I=await R.importKey("spki",e,{name:"ECDSA",namedCurve:n},!1,["verify"]);if(await R.verify({name:"ECDSA",hash:i},I,x,t)!==!0)throw new Error("ECDSA-SECP256R1-SHA256 certificate verify failed")}async function bc(r,e,t,n=!0,i=!0){for(let u of e);let s=e[0];if(s.subjectAltNameMatchingHost(r)===void 0)throw new Error(`No matching subjectAltName for ${r}`);if(!s.isValidAtMoment())throw new Error("End-user certificate is not valid now");if(n&&!s.extKeyUsage?.serverTls)throw new Error("End-user certificate has no TLS server extKeyUsage");let a=!1;for(let u of t);for(let u=0,c=e.length;u<c;u++){let h=e[u],l=h.authorityKeyIdentifier,f;if(l===void 0?f=t.find(x=>gt.distinguishedNamesAreEqual(x.subject,h.issuer)):f=t.find(x=>x.subjectKeyIdentifier!==void 0&&St(x.subjectKeyIdentifier,l)),f===void 0&&(f=e[u+1]),f===void 0)throw new Error("Ran out of certificates before reaching trusted root");let m=f instanceof dn;if(f.isValidAtMoment()!==!0)throw new Error("Signing certificate is not valid now");if(i&&f.keyUsage?.usages.has("digitalSignature")!==!0)throw new Error("Signing certificate keyUsage does not include digital signatures");if(f.basicConstraints?.ca!==!0)throw new Error("Signing certificate basicConstraints do not indicate a CA certificate");let{pathLength:b}=f.basicConstraints;if(b!==void 0&&b<u)throw new Error("Exceeded certificate path length");if(h.algorithm==="1.2.840.10045.4.3.2"||h.algorithm==="1.2.840.10045.4.3.3"){let x=h.algorithm==="1.2.840.10045.4.3.2"?"SHA-256":"SHA-384",I=f.publicKey.identifiers,T=I.includes("1.2.840.10045.3.1.7")?"P-256":I.includes("1.3.132.0.34")?"P-384":void 0;if(T===void 0)throw new Error("Unsupported signing key curve");let B=new Ht(h.signature);await Cs(B,f.publicKey.all,h.signedData,T,x)}else if(h.algorithm==="1.2.840.113549.1.1.11"||h.algorithm==="1.2.840.113549.1.1.12"){let x=h.algorithm==="1.2.840.113549.1.1.11"?"SHA-256":"SHA-384",I=await R.importKey("spki",f.publicKey.all,{name:"RSASSA-PKCS1-v1_5",hash:x},!1,["verify"]);if(await R.verify({name:"RSASSA-PKCS1-v1_5"},I,h.signature,h.signedData)!==!0)throw new Error("RSASSA_PKCS1-v1_5-SHA256 certificate verify failed")}else throw new Error("Unsupported signing algorithm");if(m){a=!0;break}}return a}async function Ec(r,e,t,n,i,s=!0,a=!0){let u=new Ht(await e());u.expectUint8(8,0);let[c]=u.expectLengthUint24(),[h,l]=u.expectLengthUint16(0);for(;l()>0;){let G=u.readUint16(0);if(G===0)u.expectUint16(0,0);else if(G===10){let[be,Ce]=u.expectLengthUint16("groups data");u.skip(Ce(),0),be()}else throw new Error(`Unsupported server encrypted extension type 0x${Be([G]).padStart(4,"0")}`)}h(),c(),u.remaining()===0&&u.extend(await e());let f=!1,m=u.readUint8();if(m===13){f=!0;let[G]=u.expectLengthUint24("certificate request data");u.expectUint8(0,0);let[be,Ce]=u.expectLengthUint16("certificate request extensions");u.skip(Ce(),0),be(),G(),u.remaining()===0&&u.extend(await e()),m=u.readUint8()}if(m!==11)throw new Error(`Unexpected handshake message type 0x${Be([m])}`);let[b]=u.expectLengthUint24(0);u.expectUint8(0,0);let[x,I]=u.expectLengthUint24(0),T=[];for(;I()>0;){let[G]=u.expectLengthUint24(0),be=new gt(u);T.push(be),G();let[Ce,Oe]=u.expectLengthUint16(),Mn=u.subarray(Oe());Ce()}if(x(),b(),T.length===0)throw new Error("No certificates supplied");let B=T[0],U=u.data.subarray(0,u.offset),A=ie(n,U),Z=await R.digest("SHA-256",A),ae=new Uint8Array(Z),j=ie(Ac.encode(" ".repeat(64)+"TLS 1.3, server CertificateVerify"),[0],ae);u.remaining()===0&&u.extend(await e()),u.expectUint8(15,0);let[V]=u.expectLengthUint24(0),k=u.readUint16();if(k===1027){let[G]=u.expectLengthUint16();await Cs(u,B.publicKey.all,j,"P-256","SHA-256"),G()}else if(k===2052){let[G,be]=u.expectLengthUint16(),Ce=u.subarray(be());G();let Oe=await R.importKey("spki",B.publicKey.all,{name:"RSA-PSS",hash:"SHA-256"},!1,["verify"]);if(await R.verify({name:"RSA-PSS",saltLength:32},Oe,Ce,j)!==!0)throw new Error("RSA-PSS-RSAE-SHA256 certificate verify failed")}else throw new Error(`Unsupported certificate verify signature type 0x${Be([k]).padStart(4,"0")}`);V();let ye=u.data.subarray(0,u.offset),P=ie(n,ye),M=await se(t,"finished",new Uint8Array(0),32,256),N=await R.digest("SHA-256",P),Q=await R.importKey("raw",M,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),$=await R.sign("HMAC",Q,N),W=new Uint8Array($);u.remaining()===0&&u.extend(await e()),u.expectUint8(20,0);let[D,oe]=u.expectLengthUint24(0),te=u.readBytes(oe());if(D(),u.remaining()!==0)throw new Error("Unexpected extra bytes in server handshake");if(St(te,W)!==!0)throw new Error("Invalid server verify hash");if(!await bc(r,T,i,s,a))throw new Error("Validated certificate chain did not end in a trusted root");return[u.data,f]}async function Us(r,e,t,n,{useSNI:i,requireServerTlsExtKeyUsage:s,requireDigitalSigKeyUsage:a,writePreData:u,expectPreData:c,commentPreData:h}={}){i??(i=!0),s??(s=!0),a??(a=!0);let l=await R.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"]),f=await R.exportKey("raw",l.publicKey),m=new Uint8Array(32);g.getRandomValues(m);let b=rc(r,f,m,i).array(),x=u?ie(u,b):b;if(n(x),c){let X=await t(c.length);if(!X||!St(X,c))throw new Error("Pre data did not match expectation")}let I=await hn(t,22);if(I===void 0)throw new Error("Connection closed while awaiting server hello");let T=new _e(I.content),B=nc(T,m),U=await hn(t,20);if(U===void 0)throw new Error("Connection closed awaiting server cipher change");let A=new _e(U.content),[Z]=A.expectLength(1);A.expectUint8(1,0),Z();let ae=b.subarray(5),j=I.content,V=ie(ae,j),k=await oc(B,l.privateKey,V,256,16),ye=await R.importKey("raw",k.serverHandshakeKey,{name:"AES-GCM"},!1,["decrypt"]),P=new qt("decrypt",ye,k.serverHandshakeIV),M=await R.importKey("raw",k.clientHandshakeKey,{name:"AES-GCM"},!1,["encrypt"]),N=new qt("encrypt",M,k.clientHandshakeIV),Q=o(async()=>{let X=await ln(t,P,22);if(X===void 0)throw new Error("Premature end of encrypted server handshake");return X},"C"),[$,W]=await Ec(r,Q,k.serverSecret,V,e,s,a),D=new _e(6);D.writeUint8(20,0),D.writeUint16(771,0);let oe=D.writeLengthUint16();D.writeUint8(1,0),oe();let te=D.array(),G=new Uint8Array(0);if(W){let X=new _e(8);X.writeUint8(11,0);let it=X.writeLengthUint24("client certificate data");X.writeUint8(0,0),X.writeUint24(0,0),it(),G=X.array()}let be=ie(V,$,G),Ce=await R.digest("SHA-256",be),Oe=new Uint8Array(Ce),Mn=await se(k.clientSecret,"finished",new Uint8Array(0),32,256),_a=await R.importKey("raw",Mn,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),Ca=await R.sign("HMAC",_a,Oe),Ua=new Uint8Array(Ca),_t=new _e(36);_t.writeUint8(20,0);let Ia=_t.writeLengthUint24(0);_t.writeBytes(Ua),Ia();let La=_t.array(),Fn=await Ss(ie(G,La),N,22),kn=Oe;if(G.length>0){let X=be.subarray(0,be.length-G.length),it=await R.digest("SHA-256",X);kn=new Uint8Array(it)}let Ct=await uc(k.handshakeSecret,kn,256,16),Ta=await R.importKey("raw",Ct.clientApplicationKey,{name:"AES-GCM"},!0,["encrypt"]),Ba=new qt("encrypt",Ta,Ct.clientApplicationIV),Pa=await R.importKey("raw",Ct.serverApplicationKey,{name:"AES-GCM"},!0,["decrypt"]),Ra=new qt("decrypt",Pa,Ct.serverApplicationIV),Ut=!1;return[()=>{if(!Ut){let X=ie(te,...Fn);n(X),Ut=!0}return ln(t,Ra)},async X=>{let it=Ut;Ut=!0;let Nn=await Ss(X,Ba,23),Ma=it?ie(...Nn):ie(te,...Fn,...Nn);n(Ma)}]}var cn,gs,tc,_e,Hf,mt,ic,R,vs,xs,cc,qt,Ht,an,jt,ne,lc,Ze,fc,dc,As,on,Ne,un,pc,Ye,yc,xc,gt,dn,Ac,vc,Is,Ls=ee(()=>{p();o(ie,"p");o(St,"O");cn="\xB7\xB7 ",gs=new TextEncoder,tc=new TextDecoder,_e=o(class{constructor(r){S(this,"offset");S(this,"dataView");S(this,"data");S(this,"comments");S(this,"indents");S(this,"indent");this.offset=0,this.data=typeof r=="number"?new Uint8Array(r):r,this.dataView=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength),this.comments={},this.indents={},this.indent=0}extend(r){let e=typeof r=="number"?new Uint8Array(r):r;this.data=ie(this.data,e),this.dataView=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength)}remaining(){return this.data.length-this.offset}subarray(r){return this.data.subarray(this.offset,this.offset+=r)}skip(r,e){return this.offset+=r,e&&this.comment(e),this}comment(r,e=this.offset){throw new Error("No comments should be emitted outside of chatty mode")}readBytes(r){return this.data.slice(this.offset,this.offset+=r)}readUTF8String(r){let e=this.subarray(r);return tc.decode(e)}readUTF8StringNullTerminated(){let r=this.offset;for(;this.data[r]!==0;)r++;let e=this.readUTF8String(r-this.offset);return this.expectUint8(0,"end of string"),e}readUint8(r){let e=this.dataView.getUint8(this.offset);return this.offset+=1,e}readUint16(r){let e=this.dataView.getUint16(this.offset);return this.offset+=2,e}readUint24(r){let e=this.readUint8(),t=this.readUint16();return(e<<16)+t}readUint32(r){let e=this.dataView.getUint32(this.offset);return this.offset+=4,e}expectBytes(r,e){let t=this.readBytes(r.length);if(!St(t,r))throw new Error("Unexpected bytes")}expectUint8(r,e){let t=this.readUint8();if(t!==r)throw new Error(`Expected ${r}, got ${t}`)}expectUint16(r,e){let t=this.readUint16();if(t!==r)throw new Error(`Expected ${r}, got ${t}`)}expectUint24(r,e){let t=this.readUint24();if(t!==r)throw new Error(`Expected ${r}, got ${t}`)}expectUint32(r,e){let t=this.readUint32();if(t!==r)throw new Error(`Expected ${r}, got ${t}`)}expectLength(r,e=1){let t=this.offset,n=t+r;if(n>this.data.length)throw new Error("Expected length exceeds remaining data length");return this.indent+=e,this.indents[t]=this.indent,[()=>{if(this.indent-=e,this.indents[this.offset]=this.indent,this.offset!==n)throw new Error(`${r} bytes expected but ${this.offset-t} read`)},()=>n-this.offset]}expectLengthUint8(r){let e=this.readUint8();return this.expectLength(e)}expectLengthUint16(r){let e=this.readUint16();return this.expectLength(e)}expectLengthUint24(r){let e=this.readUint24();return this.expectLength(e)}expectLengthUint32(r){let e=this.readUint32();return this.expectLength(e)}expectLengthUint8Incl(r){let e=this.readUint8();return this.expectLength(e-1)}expectLengthUint16Incl(r){let e=this.readUint16();return this.expectLength(e-2)}expectLengthUint24Incl(r){let e=this.readUint24();return this.expectLength(e-3)}expectLengthUint32Incl(r){let e=this.readUint32();return this.expectLength(e-4)}writeBytes(r){return this.data.set(r,this.offset),this.offset+=r.length,this}writeUTF8String(r){let e=gs.encode(r);return this.writeBytes(e),this}writeUTF8StringNullTerminated(r){let e=gs.encode(r);return this.writeBytes(e),this.writeUint8(0),this}writeUint8(r,e){return this.dataView.setUint8(this.offset,r),this.offset+=1,this}writeUint16(r,e){return this.dataView.setUint16(this.offset,r),this.offset+=2,this}writeUint24(r,e){return this.writeUint8((r&16711680)>>16),this.writeUint16(r&65535,e),this}writeUint32(r,e){return this.dataView.setUint32(this.offset,r),this.offset+=4,this}_writeLengthGeneric(r,e,t){let n=this.offset;this.offset+=r;let i=this.offset;return this.indent+=1,this.indents[i]=this.indent,()=>{let s=this.offset-(e?n:i);if(r===1)this.dataView.setUint8(n,s);else if(r===2)this.dataView.setUint16(n,s);else if(r===3)this.dataView.setUint8(n,(s&16711680)>>16),this.dataView.setUint16(n+1,s&65535);else if(r===4)this.dataView.setUint32(n,s);else throw new Error(`Invalid length for length field: ${r}`);this.indent-=1,this.indents[this.offset]=this.indent}}writeLengthUint8(r){return this._writeLengthGeneric(1,!1,r)}writeLengthUint16(r){return this._writeLengthGeneric(2,!1,r)}writeLengthUint24(r){return this._writeLengthGeneric(3,!1,r)}writeLengthUint32(r){return this._writeLengthGeneric(4,!1,r)}writeLengthUint8Incl(r){return this._writeLengthGeneric(1,!0,r)}writeLengthUint16Incl(r){return this._writeLengthGeneric(2,!0,r)}writeLengthUint24Incl(r){return this._writeLengthGeneric(3,!0,r)}writeLengthUint32Incl(r){return this._writeLengthGeneric(4,!0,r)}array(){return this.data.subarray(0,this.offset)}commentedString(r=!1){let e=this.indents[0]!==void 0?cn.repeat(this.indents[0]):"",t=this.indents[0]??0,n=r?this.data.length:this.offset;for(let i=0;i<n;i++){e+=this.data[i].toString(16).padStart(2,"0")+" ";let s=this.comments[i+1];this.indents[i+1]!==void 0&&(t=this.indents[i+1]),s&&(e+=` ${s}
${cn.repeat(t)}`)}return e}},"N");o(rc,"St");o(Be,"K");o(nc,"Ut");Hf=new RegExp(`  .+|^(${cn})+`,"gm"),mt=1<<14,ic=mt+1+255;o(hn,"ht");o(ln,"dt");o(sc,"ee");o(Ss,"At");R=g.subtle,vs=new TextEncoder;o(fn,"lt");o(ac,"ne");xs=vs.encode("tls13 ");o(se,"S");o(oc,"Kt");o(uc,"Dt");cc=2**31-1,qt=o(class{constructor(r,e,t){S(this,"recordsProcessed",0);S(this,"priorPromise",Promise.resolve(new Uint8Array));this.mode=r,this.key=e,this.initialIv=t}async process(r,e,t){let n=this.processUnsequenced(r,e,t);return this.priorPromise=this.priorPromise.then(()=>n)}async processUnsequenced(r,e,t){let n=this.recordsProcessed;if(n===cc)throw new Error("Cannot encrypt/decrypt any more records");this.recordsProcessed+=1;let i=this.initialIv.slice(),s=i.length;i[s-1]^=n&255,i[s-2]^=n>>>8&255,i[s-3]^=n>>>16&255,i[s-4]^=n>>>24&255;let a=e<<3,u={name:"AES-GCM",iv:i,tagLength:a,additionalData:t},c=await R[this.mode](u,this.key,r);return new Uint8Array(c)}},"Q");o(Qt,"yt");o(hc,"Tt");Ht=o(class extends _e{readASN1Length(r){let e=this.readUint8();if(e<128)return e;let t=e&127,n=0;if(t===1)return this.readUint8(n);if(t===2)return this.readUint16(n);if(t===3)return this.readUint24(n);if(t===4)return this.readUint32(n);throw new Error(`ASN.1 length fields are only supported up to 4 bytes (this one is ${t} bytes)`)}expectASN1Length(r){let e=this.readASN1Length(r);return this.expectLength(e)}readASN1OID(){let[r,e]=this.expectASN1Length(0),t=this.readUint8(),n=`${Math.floor(t/40)}.${t%40}`;for(;e()>0;){let i=0;for(;;){let s=this.readUint8();if(i<<=7,i+=s&127,s<128)break}n+=`.${i}`}return r(),n}readASN1Boolean(){let[r,e]=this.expectASN1Length(0),t=e();if(t!==1)throw new Error(`Boolean has weird length: ${t}`);let n=this.readUint8(),i;if(n===255)i=!0;else if(n===0)i=!1;else throw new Error(`Boolean has weird value: 0x${Be([n])}`);return r(),i}readASN1UTCTime(){let[r,e]=this.expectASN1Length(0),t=this.readUTF8String(e()).match(/^(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z$/);if(!t)throw new Error("Unrecognised ASN.1 UTC time format");let[,n,i,s,a,u,c]=t,h=parseInt(n,10),l=h+(h>=50?1900:2e3),f=new Date(`${l}-${i}-${s}T${a}:${u}:${c}Z`);return r(),f}readASN1BitString(){let[r,e]=this.expectASN1Length(0),t=this.readUint8(0),n=e(),i=this.readBytes(n);if(t>7)throw new Error(`Invalid right pad value: ${t}`);if(t>0){let s=8-t;for(let a=n-1;a>0;a--)i[a]=255&i[a-1]<<s|i[a]>>>t;i[0]=i[0]>>>t}return r(),i}},"_");o(bs,"mt");an=1,jt=2,ne=48,lc=49,Ze=6,fc=19,dc=12,As=23,on=5,Ne=4,un=3,pc=163,Ye=128,yc={"2.5.4.6":"C","2.5.4.10":"O","2.5.4.11":"OU","2.5.4.3":"CN","2.5.4.7":"L","2.5.4.8":"ST","2.5.4.12":"T","2.5.4.42":"GN","2.5.4.43":"I","2.5.4.4":"SN","1.2.840.113549.1.9.1":"E-mail"};o(wc,"qt");o(Es,"Ct");o(mc,"Bt");o(gc,"Ft");o(_s,"Ot");o(Sc,"Pt");xc=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],gt=o(class{constructor(r){S(this,"serialNumber");S(this,"algorithm");S(this,"issuer");S(this,"validityPeriod");S(this,"subject");S(this,"publicKey");S(this,"signature");S(this,"keyUsage");S(this,"subjectAltNames");S(this,"extKeyUsage");S(this,"authorityKeyIdentifier");S(this,"subjectKeyIdentifier");S(this,"basicConstraints");S(this,"signedData");let e=r instanceof Ht?r:new Ht(r);e.expectUint8(ne,0);let[t]=e.expectASN1Length(0),n=e.offset;e.expectUint8(ne,0);let[i]=e.expectASN1Length(0);e.expectBytes([160,3,2,1,2],0),e.expectUint8(jt,0);let[s,a]=e.expectASN1Length(0);this.serialNumber=e.subarray(a()),s(),e.expectUint8(ne,0);let[u,c]=e.expectASN1Length(0);e.expectUint8(Ze,0),this.algorithm=e.readASN1OID(),c()>0&&(e.expectUint8(on,0),e.expectUint8(0,0)),u(),this.issuer=Es(e,"issuer"),e.expectUint8(ne,0);let[h]=e.expectASN1Length(0);e.expectUint8(As,0);let l=e.readASN1UTCTime();e.expectUint8(As,0);let f=e.readASN1UTCTime();this.validityPeriod={notBefore:l,notAfter:f},h(),this.subject=Es(e,"subject");let m=e.offset;e.expectUint8(ne,0);let[b]=e.expectASN1Length(0);e.expectUint8(ne,0);let[x,I]=e.expectASN1Length(0),T=[];for(;I()>0;){let k=e.readUint8();if(k===Ze){let ye=e.readASN1OID();T.push(ye)}else k===on&&e.expectUint8(0,0)}x(),e.expectUint8(un,0);let B=e.readASN1BitString();this.publicKey={identifiers:T,data:B,all:e.data.subarray(m,e.offset)},b(),e.expectUint8(pc,0);let[U]=e.expectASN1Length();e.expectUint8(ne,0);let[A,Z]=e.expectASN1Length(0);for(;Z()>0;){e.expectUint8(ne,0);let[k,ye]=e.expectASN1Length();e.expectUint8(Ze,0);let P=e.readASN1OID();if(P==="2.5.29.17"){e.expectUint8(Ne,0);let[M]=e.expectASN1Length(0);e.expectUint8(ne,0);let N=mc(e,Ye);this.subjectAltNames=N.filter(Q=>Q.type===(2|Ye)).map(Q=>Q.name),M()}else if(P==="2.5.29.15"){e.expectUint8(an,0);let M=e.readASN1Boolean();e.expectUint8(Ne,0);let[N]=e.expectASN1Length(0);e.expectUint8(un,0);let Q=e.readASN1BitString(),$=wc(Q),W=new Set(xc.filter((D,oe)=>$&1<<oe));N(),this.keyUsage={critical:M,usages:W}}else if(P==="2.5.29.37"){this.extKeyUsage={},e.expectUint8(Ne,0);let[M]=e.expectASN1Length(0);e.expectUint8(ne,0);let[N,Q]=e.expectASN1Length(0);for(;Q()>0;){e.expectUint8(Ze,0);let $=e.readASN1OID();$==="1.3.6.1.5.5.7.3.1"&&(this.extKeyUsage.serverTls=!0),$==="1.3.6.1.5.5.7.3.2"&&(this.extKeyUsage.clientTls=!0)}N(),M()}else if(P==="2.5.29.35"){e.expectUint8(Ne,0);let[M]=e.expectASN1Length(0);e.expectUint8(ne,0);let[N,Q]=e.expectASN1Length(0);for(;Q()>0;){let $=e.readUint8();if($===(Ye|0)){let[W,D]=e.expectASN1Length(0);this.authorityKeyIdentifier=e.readBytes(D()),W()}else if($===(Ye|1)){let[W,D]=e.expectASN1Length(0);e.skip(D(),0),W()}else if($===(Ye|2)){let[W,D]=e.expectASN1Length(0);e.skip(D(),0),W()}else if($===(Ye|33)){let[W,D]=e.expectASN1Length(0);e.skip(D(),0),W()}else throw new Error(`Unexpected data type ${$} in authorityKeyIdentifier certificate extension`)}N(),M()}else if(P==="2.5.29.14"){e.expectUint8(Ne,0);let[M]=e.expectASN1Length(0);e.expectUint8(Ne,0);let[N,Q]=e.expectASN1Length(0);this.subjectKeyIdentifier=e.readBytes(Q()),N(),M()}else if(P==="2.5.29.19"){let M,N=e.readUint8();if(N===an&&(M=e.readASN1Boolean(),N=e.readUint8()),N!==Ne)throw new Error("Unexpected type in certificate basic constraints");let[Q]=e.expectASN1Length(0);e.expectUint8(ne,0);let[$,W]=e.expectASN1Length(),D;W()>0&&(e.expectUint8(an,0),D=e.readASN1Boolean());let oe;if(W()>0){e.expectUint8(jt,0);let te=e.readASN1Length(0);if(oe=te===1?e.readUint8():te===2?e.readUint16():te===3?e.readUint24():void 0,oe===void 0)throw new Error("Too many bytes in max path length in certificate basicConstraints")}$(),Q(),this.basicConstraints={critical:M,ca:D,pathLength:oe}}else e.skip(ye(),0);k()}A(),U(),i(),this.signedData=e.data.subarray(n,e.offset),e.expectUint8(ne,0);let[ae,j]=e.expectASN1Length(0);e.expectUint8(Ze,0);let V=e.readASN1OID();if(j()>0&&(e.expectUint8(on,0),e.expectUint8(0,0)),ae(),V!==this.algorithm)throw new Error(`Certificate specifies different signature algorithms inside (${this.algorithm}) and out (${V})`);e.expectUint8(un,0),this.signature=e.readASN1BitString(),t()}static distinguishedNamesAreEqual(r,e){return bs(r)===bs(e)}static readableDN(r){return Object.entries(r).map(e=>e.join("=")).join(", ")}static fromPEM(r){let e="[A-Z0-9 ]+",t=new RegExp(`-{5}BEGIN ${e}-{5}([a-zA-Z0-9=+\\/\\n\\r]+)-{5}END ${e}-{5}`,"g"),n=[],i=null;for(;i=t.exec(r);){let s=i[1].replace(/[\r\n]/g,""),a=hc(s),u=new this(a);n.push(u)}return n}subjectAltNameMatchingHost(r){let e=/[.][^.]+[.][^.]+$/;return(this.subjectAltNames??[]).find(t=>{let n=t,i=r;if(e.test(r)&&e.test(n)&&n.startsWith("*.")&&(n=n.slice(1),i=i.slice(i.indexOf("."))),n===i)return!0})}isValidAtMoment(r=new Date){return r>=this.validityPeriod.notBefore&&r<=this.validityPeriod.notAfter}description(){return"subject: "+gt.readableDN(this.subject)+(this.subjectAltNames?`
subject alt names: `+this.subjectAltNames.join(", "):"")+(this.subjectKeyIdentifier?`
subject key id: ${Be(this.subjectKeyIdentifier," ")}`:"")+`
issuer: `+gt.readableDN(this.issuer)+(this.authorityKeyIdentifier?`
authority key id: ${Be(this.authorityKeyIdentifier," ")}`:"")+`
validity: `+this.validityPeriod.notBefore.toISOString()+" \u2013 "+this.validityPeriod.notAfter.toISOString()+` (${this.isValidAtMoment()?"currently valid":"not valid"})`+(this.keyUsage?`
key usage (${this.keyUsage.critical?"critical":"non-critical"}): `+[...this.keyUsage.usages].join(", "):"")+(this.extKeyUsage?`
extended key usage: TLS server \u2014\xA0${this.extKeyUsage.serverTls}, TLS client \u2014\xA0${this.extKeyUsage.clientTls}`:"")+(this.basicConstraints?`
basic constraints (${this.basicConstraints.critical?"critical":"non-critical"}): CA \u2014\xA0${this.basicConstraints.ca}, path length \u2014 ${this.basicConstraints.pathLength}`:"")+`
signature algorithm: `+Sc(gc(this.algorithm))}toJSON(){return{serialNumber:[...this.serialNumber],algorithm:this.algorithm,issuer:this.issuer,validityPeriod:{notBefore:this.validityPeriod.notBefore.toISOString(),notAfter:this.validityPeriod.notAfter.toISOString()},subject:this.subject,publicKey:{identifiers:this.publicKey.identifiers,data:[...this.publicKey.data],all:[...this.publicKey.all]},signature:[...this.signature],keyUsage:{critical:this.keyUsage?.critical,usages:[...this.keyUsage?.usages??[]]},subjectAltNames:this.subjectAltNames,extKeyUsage:this.extKeyUsage,authorityKeyIdentifier:this.authorityKeyIdentifier&&[...this.authorityKeyIdentifier],subjectKeyIdentifier:this.subjectKeyIdentifier&&[...this.subjectKeyIdentifier],basicConstraints:this.basicConstraints,signedData:[...this.signedData]}}},"P"),dn=o(class extends gt{},"st");o(Cs,"pt");o(bc,"jt");Ac=new TextEncoder;o(Ec,"Vt");o(Us,"de");vc=o(class{constructor(){S(this,"queue");S(this,"outstandingRequest");this.queue=[]}enqueue(r){this.queue.push(r),this.dequeue()}dequeue(){if(this.outstandingRequest===void 0)return;let{resolve:r,bytes:e}=this.outstandingRequest,t=this.bytesInQueue();if(t<e&&this.socketIsNotClosed())return;if(e=Math.min(e,t),e===0)return r(void 0);this.outstandingRequest=void 0;let n=this.queue[0],i=n.length;if(i===e)return this.queue.shift(),r(n);if(i>e)return this.queue[0]=n.subarray(e),r(n.subarray(0,e));{let s=new Uint8Array(e),a=e,u=0;for(;a>0;){let c=this.queue[0],h=c.length;h<=a?(this.queue.shift(),s.set(c,u),u+=h,a-=h):(this.queue[0]=c.subarray(a),s.set(c.subarray(0,a),u),a-=a,u+=a)}return r(s)}}bytesInQueue(){return this.queue.reduce((r,e)=>r+e.length,0)}async read(r){if(this.outstandingRequest!==void 0)throw new Error("Can\u2019t read while already awaiting read");return new Promise(e=>{this.outstandingRequest={resolve:e,bytes:r},this.dequeue()})}},"xt"),Is=o(class extends vc{constructor(r){super(),this.socket=r,r.addEventListener("message",e=>this.enqueue(new Uint8Array(e.data))),r.addEventListener("close",()=>this.dequeue())}socketIsNotClosed(){let{socket:r}=this,{readyState:e}=r;return e<=1}},"vt")});var pn,Ts=ee(()=>{pn=`-----BEGIN CERTIFICATE-----
MIIFazCCA1OgAwIBAgIRAIIQz7DSQONZRGPgu2OCiwAwDQYJKoZIhvcNAQELBQAw
TzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2Vh
cmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMTUwNjA0MTEwNDM4
WhcNMzUwNjA0MTEwNDM4WjBPMQswCQYDVQQGEwJVUzEpMCcGA1UEChMgSW50ZXJu
ZXQgU2VjdXJpdHkgUmVzZWFyY2ggR3JvdXAxFTATBgNVBAMTDElTUkcgUm9vdCBY
MTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAK3oJHP0FDfzm54rVygc
h77ct984kIxuPOZXoHj3dcKi/vVqbvYATyjb3miGbESTtrFj/RQSa78f0uoxmyF+
0TM8ukj13Xnfs7j/EvEhmkvBioZxaUpmZmyPfjxwv60pIgbz5MDmgK7iS4+3mX6U
A5/TR5d8mUgjU+g4rk8Kb4Mu0UlXjIB0ttov0DiNewNwIRt18jA8+o+u3dpjq+sW
T8KOEUt+zwvo/7V3LvSye0rgTBIlDHCNAymg4VMk7BPZ7hm/ELNKjD+Jo2FR3qyH
B5T0Y3HsLuJvW5iB4YlcNHlsdu87kGJ55tukmi8mxdAQ4Q7e2RCOFvu396j3x+UC
B5iPNgiV5+I3lg02dZ77DnKxHZu8A/lJBdiB3QW0KtZB6awBdpUKD9jf1b0SHzUv
KBds0pjBqAlkd25HN7rOrFleaJ1/ctaJxQZBKT5ZPt0m9STJEadao0xAH0ahmbWn
OlFuhjuefXKnEgV4We0+UXgVCwOPjdAvBbI+e0ocS3MFEvzG6uBQE3xDk3SzynTn
jh8BCNAw1FtxNrQHusEwMFxIt4I7mKZ9YIqioymCzLq9gwQbooMDQaHWBfEbwrbw
qHyGO0aoSCqI3Haadr8faqU9GY/rOPNk3sgrDQoo//fb4hVC1CLQJ13hef4Y53CI
rU7m2Ys6xt0nUW7/vGT1M0NPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNV
HRMBAf8EBTADAQH/MB0GA1UdDgQWBBR5tFnme7bl5AFzgAiIyBpY9umbbjANBgkq
hkiG9w0BAQsFAAOCAgEAVR9YqbyyqFDQDLHYGmkgJykIrGF1XIpu+ILlaS/V9lZL
ubhzEFnTIZd+50xx+7LSYK05qAvqFyFWhfFQDlnrzuBZ6brJFe+GnY+EgPbk6ZGQ
3BebYhtF8GaV0nxvwuo77x/Py9auJ/GpsMiu/X1+mvoiBOv/2X/qkSsisRcOj/KK
NFtY2PwByVS5uCbMiogziUwthDyC3+6WVwW6LLv3xLfHTjuCvjHIInNzktHCgKQ5
ORAzI4JMPJ+GslWYHb4phowim57iaztXOoJwTdwJx4nLCgdNbOhdjsnvzqvHu7Ur
TkXWStAmzOVyyghqpZXjFaH3pO3JLF+l+/+sKAIuvtd7u+Nxe5AW0wdeRlN8NwdC
jNPElpzVmbUq4JUagEiuTDkHzsxHpFKVK7q4+63SM1N95R1NbdWhscdCb+ZAJzVc
oyi3B43njTOQ5yOf+1CceWxG1bQVs5ZufpsMljq4Ui0/1lvh+wjChP4kqKOJ2qxq
4RgqsahDYVvTH9w7jXbyLeiNdd8XM2w9U/t7y0Ff/9yi0GE44Za4rF2LN9d11TPA
mRGunUHBcnWEvgJBQl9nJEiU0Zsnvgc/ubhPgXRR4Xq37Z0j4r7g1SgEEzwxA57d
emyPxgcYxn/eR44/KJ4EBs+lVDR3veyJm+kXQ99b21/+jh5Xos1AnX5iItreGCc=
-----END CERTIFICATE-----
`});var Kt={};we(Kt,{Socket:()=>ce,isIP:()=>Cc});function Cc(r){return 0}var Bs,J,ce,xt=ee(()=>{"use strict";p();Bs=st(Ie(),1);Ls();Ts();o(Cc,"isIP");J=class extends Bs.EventEmitter{constructor(){super(...arguments);S(this,"_webSocketConstructor");S(this,"_wsProxy");S(this,"_coalesceWrites");S(this,"_useSecureWebSocket");S(this,"_disableSNI");S(this,"_pipelineConnect");S(this,"_pipelineTLS");S(this,"_rootCerts");S(this,"connecting",!1);S(this,"pending",!0);S(this,"writable",!0);S(this,"encrypted",!1);S(this,"authorized",!1);S(this,"destroyed",!1);S(this,"ws",null);S(this,"writeBuffer");S(this,"tlsState",0);S(this,"tlsRead");S(this,"tlsWrite")}get webSocketConstructor(){return this._webSocketConstructor??J.webSocketConstructor??J.defaults.webSocketConstructor}set webSocketConstructor(t){this._webSocketConstructor=t}get wsProxy(){return this._wsProxy??J.wsProxy??J.defaults.wsProxy}set wsProxy(t){this._wsProxy=t}get coalesceWrites(){return this._coalesceWrites??J.coalesceWrites??J.defaults.coalesceWrites}set coalesceWrites(t){this._coalesceWrites=t}get useSecureWebSocket(){return this._useSecureWebSocket??J.useSecureWebSocket??J.defaults.useSecureWebSocket}set useSecureWebSocket(t){this._useSecureWebSocket=t}get disableSNI(){return this._disableSNI??J.disableSNI??J.defaults.disableSNI}set disableSNI(t){this._disableSNI=t}get pipelineConnect(){return this._pipelineConnect??J.pipelineConnect??J.defaults.pipelineConnect}set pipelineConnect(t){this._pipelineConnect=t}get pipelineTLS(){return this._pipelineTLS??J.pipelineTLS??J.defaults.pipelineTLS}set pipelineTLS(t){this._pipelineTLS=t}get rootCerts(){return this._rootCerts??J.rootCerts??J.defaults.rootCerts}set rootCerts(t){this._rootCerts=t}wsProxyAddrForHost(t,n){let i=this.wsProxy;if(i===void 0)throw new Error("No WebSocket proxy is configured. Please refer to https://github.com/neondatabase/serverless#run-your-own-websocket-proxy");return typeof i=="function"?i(t,n):`${i}?address=${t}:${n}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}async connect(t,n,i){this.connecting=!0,i&&this.once("connect",i);let s;try{s=this.wsProxyAddrForHost(n,typeof t=="string"?parseInt(t,10):t)}catch(a){this.emit("error",a),this.emit("close");return}return this.ws=await new Promise(async a=>{try{let c=(this.useSecureWebSocket?"wss:":"ws:")+"//"+s,h;if(this.webSocketConstructor!==void 0)h=new this.webSocketConstructor(c);else try{h=new WebSocket(c)}catch{h=new __unstable_WebSocket(c)}h.addEventListener("open",()=>{a(h)})}catch(u){try{let h=(this.useSecureWebSocket?"https:":"http:")+"//"+s;await fetch(h,{headers:{Upgrade:"websocket"}}).then(l=>{let f=l.webSocket;if(f==null)throw u;f.accept(),a(f)})}catch{this.emit("error",new Error("All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless#run-on-node")),this.emit("close");return}}}),this.ws.binaryType="arraybuffer",this.ws.addEventListener("error",a=>{this.emit("error",a),this.emit("close")}),this.ws.addEventListener("close",()=>{this.emit("close")}),this.ws.addEventListener("message",a=>{if(this.tlsState===0){let u=y.from(a.data);this.emit("data",u)}}),this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready"),this}async startTls(t){this.tlsState=1;let n=dn.fromPEM(pn),i=new Is(this.ws),s=i.read.bind(i),a=this.rawWrite.bind(this),[u,c]=await Us(t,n,s,a,!this.disableSNI,void 0,this.pipelineTLS?new Uint8Array([83]):void 0);this.tlsRead=u,this.tlsWrite=c,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let t=await this.tlsRead();if(t===void 0)break;{let n=y.from(t);this.emit("data",n)}}}rawWrite(t){if(!this.coalesceWrites){this.ws.send(t);return}if(this.writeBuffer===void 0)this.writeBuffer=t,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let n=new Uint8Array(this.writeBuffer.length+t.length);n.set(this.writeBuffer),n.set(t,this.writeBuffer.length),this.writeBuffer=n}}write(t,n="utf8",i=s=>{}){return t.length===0?i():(typeof t=="string"&&(t=y.from(t,n)),this.tlsState===0?this.rawWrite(t):this.tlsState===1?this.once("secureConnection",()=>this.write(t,n,i)):this.tlsWrite(t),!0)}end(t=y.alloc(0),n="utf8",i){return this.write(t,n,()=>{this.ws.close(),i&&i()}),this}destroy(){return this.destroyed=!0,this.end()}},ce=J;o(ce,"Socket"),S(ce,"defaults",{webSocketConstructor:void 0,wsProxy:t=>t+"/v2",useSecureWebSocket:!0,coalesceWrites:!0,disableSNI:!1,pipelineConnect:"password",pipelineTLS:!1,rootCerts:pn}),S(ce,"webSocketConstructor"),S(ce,"wsProxy"),S(ce,"coalesceWrites"),S(ce,"useSecureWebSocket"),S(ce,"disableSNI"),S(ce,"pipelineConnect"),S(ce,"pipelineTLS"),S(ce,"rootCerts")});var yn=L(C=>{"use strict";p();Object.defineProperty(C,"__esModule",{value:!0});C.NoticeMessage=C.DataRowMessage=C.CommandCompleteMessage=C.ReadyForQueryMessage=C.NotificationResponseMessage=C.BackendKeyDataMessage=C.AuthenticationMD5Password=C.ParameterStatusMessage=C.ParameterDescriptionMessage=C.RowDescriptionMessage=C.Field=C.CopyResponse=C.CopyDataMessage=C.DatabaseError=C.copyDone=C.emptyQuery=C.replicationStart=C.portalSuspended=C.noData=C.closeComplete=C.bindComplete=C.parseComplete=void 0;C.parseComplete={name:"parseComplete",length:5};C.bindComplete={name:"bindComplete",length:5};C.closeComplete={name:"closeComplete",length:5};C.noData={name:"noData",length:5};C.portalSuspended={name:"portalSuspended",length:5};C.replicationStart={name:"replicationStart",length:4};C.emptyQuery={name:"emptyQuery",length:4};C.copyDone={name:"copyDone",length:4};var $t=class extends Error{constructor(e,t,n){super(e),this.length=t,this.name=n}};o($t,"DatabaseError");C.DatabaseError=$t;var Wt=class{constructor(e,t){this.length=e,this.chunk=t,this.name="copyData"}};o(Wt,"CopyDataMessage");C.CopyDataMessage=Wt;var Gt=class{constructor(e,t,n,i){this.length=e,this.name=t,this.binary=n,this.columnTypes=new Array(i)}};o(Gt,"CopyResponse");C.CopyResponse=Gt;var Vt=class{constructor(e,t,n,i,s,a,u){this.name=e,this.tableID=t,this.columnID=n,this.dataTypeID=i,this.dataTypeSize=s,this.dataTypeModifier=a,this.format=u}};o(Vt,"Field");C.Field=Vt;var zt=class{constructor(e,t){this.length=e,this.fieldCount=t,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};o(zt,"RowDescriptionMessage");C.RowDescriptionMessage=zt;var Jt=class{constructor(e,t){this.length=e,this.parameterCount=t,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};o(Jt,"ParameterDescriptionMessage");C.ParameterDescriptionMessage=Jt;var Yt=class{constructor(e,t,n){this.length=e,this.parameterName=t,this.parameterValue=n,this.name="parameterStatus"}};o(Yt,"ParameterStatusMessage");C.ParameterStatusMessage=Yt;var Zt=class{constructor(e,t){this.length=e,this.salt=t,this.name="authenticationMD5Password"}};o(Zt,"AuthenticationMD5Password");C.AuthenticationMD5Password=Zt;var Xt=class{constructor(e,t,n){this.length=e,this.processID=t,this.secretKey=n,this.name="backendKeyData"}};o(Xt,"BackendKeyDataMessage");C.BackendKeyDataMessage=Xt;var er=class{constructor(e,t,n,i){this.length=e,this.processId=t,this.channel=n,this.payload=i,this.name="notification"}};o(er,"NotificationResponseMessage");C.NotificationResponseMessage=er;var tr=class{constructor(e,t){this.length=e,this.status=t,this.name="readyForQuery"}};o(tr,"ReadyForQueryMessage");C.ReadyForQueryMessage=tr;var rr=class{constructor(e,t){this.length=e,this.text=t,this.name="commandComplete"}};o(rr,"CommandCompleteMessage");C.CommandCompleteMessage=rr;var nr=class{constructor(e,t){this.length=e,this.fields=t,this.name="dataRow",this.fieldCount=t.length}};o(nr,"DataRowMessage");C.DataRowMessage=nr;var ir=class{constructor(e,t){this.length=e,this.message=t,this.name="notice"}};o(ir,"NoticeMessage");C.NoticeMessage=ir});var Ps=L(ar=>{"use strict";p();Object.defineProperty(ar,"__esModule",{value:!0});ar.Writer=void 0;var sr=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=y.allocUnsafe(e)}ensure(e){var t=this.buffer.length-this.offset;if(t<e){var n=this.buffer,i=n.length+(n.length>>1)+e;this.buffer=y.allocUnsafe(i),n.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var t=y.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}return this.buffer[this.offset++]=0,this}addString(e=""){var t=y.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=y.allocUnsafe(this.size),t}};o(sr,"Writer");ar.Writer=sr});var Ms=L(ur=>{"use strict";p();Object.defineProperty(ur,"__esModule",{value:!0});ur.serialize=void 0;var wn=Ps(),q=new wn.Writer,Uc=o(r=>{q.addInt16(3).addInt16(0);for(let n of Object.keys(r))q.addCString(n).addCString(r[n]);q.addCString("client_encoding").addCString("UTF8");var e=q.addCString("").flush(),t=e.length+4;return new wn.Writer().addInt32(t).add(e).flush()},"startup"),Ic=o(()=>{let r=y.allocUnsafe(8);return r.writeInt32BE(8,0),r.writeInt32BE(80877103,4),r},"requestSsl"),Lc=o(r=>q.addCString(r).flush(112),"password"),Tc=o(function(r,e){return q.addCString(r).addInt32(y.byteLength(e)).addString(e),q.flush(112)},"sendSASLInitialResponseMessage"),Bc=o(function(r){return q.addString(r).flush(112)},"sendSCRAMClientFinalMessage"),Pc=o(r=>q.addCString(r).flush(81),"query"),Rs=[],Rc=o(r=>{let e=r.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let t=r.types||Rs;for(var n=t.length,i=q.addCString(e).addCString(r.text).addInt16(n),s=0;s<n;s++)i.addInt32(t[s]);return q.flush(80)},"parse"),Xe=new wn.Writer,Mc=o(function(r,e){for(let t=0;t<r.length;t++){let n=e?e(r[t],t):r[t];n==null?(q.addInt16(0),Xe.addInt32(-1)):n instanceof y?(q.addInt16(1),Xe.addInt32(n.length),Xe.add(n)):(q.addInt16(0),Xe.addInt32(y.byteLength(n)),Xe.addString(n))}},"writeValues"),Fc=o((r={})=>{let e=r.portal||"",t=r.statement||"",n=r.binary||!1,i=r.values||Rs,s=i.length;return q.addCString(e).addCString(t),q.addInt16(s),Mc(i,r.valueMapper),q.addInt16(s),q.add(Xe.flush()),q.addInt16(n?1:0),q.flush(66)},"bind"),kc=y.from([69,0,0,0,9,0,0,0,0,0]),Nc=o(r=>{if(!r||!r.portal&&!r.rows)return kc;let e=r.portal||"",t=r.rows||0,n=y.byteLength(e),i=4+n+1+4,s=y.allocUnsafe(1+i);return s[0]=69,s.writeInt32BE(i,1),s.write(e,5,"utf-8"),s[n+5]=0,s.writeUInt32BE(t,s.length-4),s},"execute"),Dc=o((r,e)=>{let t=y.allocUnsafe(16);return t.writeInt32BE(16,0),t.writeInt16BE(1234,4),t.writeInt16BE(5678,6),t.writeInt32BE(r,8),t.writeInt32BE(e,12),t},"cancel"),mn=o((r,e)=>{let n=4+y.byteLength(e)+1,i=y.allocUnsafe(1+n);return i[0]=r,i.writeInt32BE(n,1),i.write(e,5,"utf-8"),i[n]=0,i},"cstringMessage"),Oc=q.addCString("P").flush(68),qc=q.addCString("S").flush(68),Qc=o(r=>r.name?mn(68,`${r.type}${r.name||""}`):r.type==="P"?Oc:qc,"describe"),Hc=o(r=>{let e=`${r.type}${r.name||""}`;return mn(67,e)},"close"),jc=o(r=>q.add(r).flush(100),"copyData"),Kc=o(r=>mn(102,r),"copyFail"),or=o(r=>y.from([r,0,0,0,4]),"codeOnlyBuffer"),$c=or(72),Wc=or(83),Gc=or(88),Vc=or(99),zc={startup:Uc,password:Lc,requestSsl:Ic,sendSASLInitialResponseMessage:Tc,sendSCRAMClientFinalMessage:Bc,query:Pc,parse:Rc,bind:Fc,execute:Nc,describe:Qc,close:Hc,flush:()=>$c,sync:()=>Wc,end:()=>Gc,copyData:jc,copyDone:()=>Vc,copyFail:Kc,cancel:Dc};ur.serialize=zc});var Fs=L(hr=>{"use strict";p();Object.defineProperty(hr,"__esModule",{value:!0});hr.BufferReader=void 0;var Jc=y.allocUnsafe(0),cr=class{constructor(e=0){this.offset=e,this.buffer=Jc,this.encoding="utf-8"}setBuffer(e,t){this.offset=e,this.buffer=t}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}string(e){let t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}cstring(){let e=this.offset,t=e;for(;this.buffer[t++]!==0;);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}bytes(e){let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}};o(cr,"BufferReader");hr.BufferReader=cr});var ks={};we(ks,{default:()=>Yc});var Yc,Ns=ee(()=>{p();Yc={}});var qs=L(et=>{"use strict";p();var Zc=et&&et.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(et,"__esModule",{value:!0});et.Parser=void 0;var H=yn(),Xc=Fs(),eh=Zc((Ns(),K(ks))),gn=1,th=4,Ds=gn+th,Os=y.allocUnsafe(0),lr=class{constructor(e){if(this.buffer=Os,this.bufferLength=0,this.bufferOffset=0,this.reader=new Xc.BufferReader,e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,t){this.mergeBuffer(e);let n=this.bufferOffset+this.bufferLength,i=this.bufferOffset;for(;i+Ds<=n;){let s=this.buffer[i],a=this.buffer.readUInt32BE(i+gn),u=gn+a;if(u+i<=n){let c=this.handlePacket(i+Ds,s,a,this.buffer);t(c),i+=u}else break}i===n?(this.buffer=Os,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=n-i,this.bufferOffset=i)}mergeBuffer(e){if(this.bufferLength>0){let t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){let i;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)i=this.buffer;else{let s=this.buffer.byteLength*2;for(;t>=s;)s*=2;i=y.allocUnsafe(s)}this.buffer.copy(i,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=i,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,t,n,i){switch(t){case 50:return H.bindComplete;case 49:return H.parseComplete;case 51:return H.closeComplete;case 110:return H.noData;case 115:return H.portalSuspended;case 99:return H.copyDone;case 87:return H.replicationStart;case 73:return H.emptyQuery;case 68:return this.parseDataRowMessage(e,n,i);case 67:return this.parseCommandCompleteMessage(e,n,i);case 90:return this.parseReadyForQueryMessage(e,n,i);case 65:return this.parseNotificationMessage(e,n,i);case 82:return this.parseAuthenticationResponse(e,n,i);case 83:return this.parseParameterStatusMessage(e,n,i);case 75:return this.parseBackendKeyData(e,n,i);case 69:return this.parseErrorMessage(e,n,i,"error");case 78:return this.parseErrorMessage(e,n,i,"notice");case 84:return this.parseRowDescriptionMessage(e,n,i);case 116:return this.parseParameterDescriptionMessage(e,n,i);case 71:return this.parseCopyInMessage(e,n,i);case 72:return this.parseCopyOutMessage(e,n,i);case 100:return this.parseCopyData(e,n,i);default:eh.default.fail(`unknown message code: ${t.toString(16)}`)}}parseReadyForQueryMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.string(1);return new H.ReadyForQueryMessage(t,i)}parseCommandCompleteMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.cstring();return new H.CommandCompleteMessage(t,i)}parseCopyData(e,t,n){let i=n.slice(e,e+(t-4));return new H.CopyDataMessage(t,i)}parseCopyInMessage(e,t,n){return this.parseCopyMessage(e,t,n,"copyInResponse")}parseCopyOutMessage(e,t,n){return this.parseCopyMessage(e,t,n,"copyOutResponse")}parseCopyMessage(e,t,n,i){this.reader.setBuffer(e,n);let s=this.reader.byte()!==0,a=this.reader.int16(),u=new H.CopyResponse(t,i,s,a);for(let c=0;c<a;c++)u.columnTypes[c]=this.reader.int16();return u}parseNotificationMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.cstring(),a=this.reader.cstring();return new H.NotificationResponseMessage(t,i,s,a)}parseRowDescriptionMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new H.RowDescriptionMessage(t,i);for(let a=0;a<i;a++)s.fields[a]=this.parseField();return s}parseField(){let e=this.reader.cstring(),t=this.reader.int32(),n=this.reader.int16(),i=this.reader.int32(),s=this.reader.int16(),a=this.reader.int32(),u=this.reader.int16()===0?"text":"binary";return new H.Field(e,t,n,i,s,a,u)}parseParameterDescriptionMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new H.ParameterDescriptionMessage(t,i);for(let a=0;a<i;a++)s.dataTypeIDs[a]=this.reader.int32();return s}parseDataRowMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new Array(i);for(let a=0;a<i;a++){let u=this.reader.int32();s[a]=u===-1?null:this.reader.string(u)}return new H.DataRowMessage(t,s)}parseParameterStatusMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.cstring(),s=this.reader.cstring();return new H.ParameterStatusMessage(t,i,s)}parseBackendKeyData(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.int32();return new H.BackendKeyDataMessage(t,i,s)}parseAuthenticationResponse(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s={name:"authenticationOk",length:t};switch(i){case 0:break;case 3:s.length===8&&(s.name="authenticationCleartextPassword");break;case 5:if(s.length===12){s.name="authenticationMD5Password";let u=this.reader.bytes(4);return new H.AuthenticationMD5Password(t,u)}break;case 10:s.name="authenticationSASL",s.mechanisms=[];let a;do a=this.reader.cstring(),a&&s.mechanisms.push(a);while(a);break;case 11:s.name="authenticationSASLContinue",s.data=this.reader.string(t-8);break;case 12:s.name="authenticationSASLFinal",s.data=this.reader.string(t-8);break;default:throw new Error("Unknown authenticationOk message type "+i)}return s}parseErrorMessage(e,t,n,i){this.reader.setBuffer(e,n);let s={},a=this.reader.string(1);for(;a!=="\0";)s[a]=this.reader.cstring(),a=this.reader.string(1);let u=s.M,c=i==="notice"?new H.NoticeMessage(t,u):new H.DatabaseError(u,t,i);return c.severity=s.S,c.code=s.C,c.detail=s.D,c.hint=s.H,c.position=s.P,c.internalPosition=s.p,c.internalQuery=s.q,c.where=s.W,c.schema=s.s,c.table=s.t,c.column=s.c,c.dataType=s.d,c.constraint=s.n,c.file=s.F,c.line=s.L,c.routine=s.R,c}};o(lr,"Parser");et.Parser=lr});var Sn=L(Pe=>{"use strict";p();Object.defineProperty(Pe,"__esModule",{value:!0});Pe.DatabaseError=Pe.serialize=Pe.parse=void 0;var rh=yn();Object.defineProperty(Pe,"DatabaseError",{enumerable:!0,get:function(){return rh.DatabaseError}});var nh=Ms();Object.defineProperty(Pe,"serialize",{enumerable:!0,get:function(){return nh.serialize}});var ih=qs();function sh(r,e){let t=new ih.Parser;return r.on("data",n=>t.parse(n,e)),new Promise(n=>r.on("end",()=>n()))}o(sh,"parse");Pe.parse=sh});var Hs={};we(Hs,{CloudflareSocket:()=>fr});function oh(r){if(r instanceof Uint8Array||r instanceof ArrayBuffer){let e=y.from(r).toString("hex");return`
>>> STR: "${new TextDecoder().decode(r).replace(/\n/g,"\\n")}"
>>> HEX: ${e}
`}else return r}function me(...r){ah&&console.log(...r.map(oh))}var Qs,fr,ah,js=ee(()=>{p();Qs=st(Ie()),fr=class extends Qs.EventEmitter{constructor(e){super(),this.ssl=e,this.writable=!1,this.destroyed=!1,this._upgrading=!1,this._upgraded=!1,this._cfSocket=null,this._cfWriter=null,this._cfReader=null}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}async connect(e,t,n){try{me("connecting"),n&&this.once("connect",n);let i=this.ssl?{secureTransport:"starttls"}:{},{connect:s}=await import("cloudflare:sockets");return this._cfSocket=s(`${t}:${e}`,i),this._cfWriter=this._cfSocket.writable.getWriter(),this._addClosedHandler(),this._cfReader=this._cfSocket.readable.getReader(),this.ssl?this._listenOnce().catch(a=>this.emit("error",a)):this._listen().catch(a=>this.emit("error",a)),await this._cfWriter.ready,me("socket ready"),this.writable=!0,this.emit("connect"),this}catch(i){this.emit("error",i)}}async _listen(){for(;;){me("awaiting receive from CF socket");let{done:e,value:t}=await this._cfReader.read();if(me("CF socket received:",e,t),e){me("done");break}this.emit("data",y.from(t))}}async _listenOnce(){me("awaiting first receive from CF socket");let{done:e,value:t}=await this._cfReader.read();me("First CF socket received:",e,t),this.emit("data",y.from(t))}write(e,t="utf8",n=()=>{}){return e.length===0?n():(typeof e=="string"&&(e=y.from(e,t)),me("sending data direct:",e),this._cfWriter.write(e).then(()=>{me("data sent"),n()},i=>{me("send error",i),n(i)}),!0)}end(e=y.alloc(0),t="utf8",n=()=>{}){return me("ending CF socket"),this.write(e,t,i=>{this._cfSocket.close(),n&&n(i)}),this}destroy(e){return me("destroying CF socket",e),this.destroyed=!0,this.end()}startTls(e){if(this._upgraded){this.emit("error","Cannot call `startTls()` more than once on a socket");return}this._cfWriter.releaseLock(),this._cfReader.releaseLock(),this._upgrading=!0,this._cfSocket=this._cfSocket.startTls(e),this._cfWriter=this._cfSocket.writable.getWriter(),this._cfReader=this._cfSocket.readable.getReader(),this._addClosedHandler(),this._listen().catch(t=>this.emit("error",t))}_addClosedHandler(){this._cfSocket.closed.then(()=>{this._upgrading?(this._upgrading=!1,this._upgraded=!0):(me("CF socket closed"),this._cfSocket=null,this.emit("close"))}).catch(e=>this.emit("error",e))}};o(fr,"CloudflareSocket");ah=!1;o(oh,"dump");o(me,"log")});var Ks={};we(Ks,{connect:()=>uh});function uh(r){let{socket:e,servername:t}=r;return e.startTls(t),e}var $s=ee(()=>{p();o(uh,"connect")});var Ws=L((Ud,xn)=>{p();xn.exports.getStream=o(function(e){let t=(xt(),K(Kt));if(typeof t.Socket=="function")return new t.Socket;{let{CloudflareSocket:n}=(js(),K(Hs));return new n(e)}},"getStream");xn.exports.getSecureStream=o(function(e){var t=($s(),K(Ks));return t.connect?t.connect(e):(e.socket.startTls(e),e.socket)},"getSecureStream")});var bn=L((Bd,Gs)=>{"use strict";p();var Td=(xt(),K(Kt)),ch=Ie().EventEmitter,{parse:hh,serialize:Y}=Sn(),{getStream:lh,getSecureStream:fh}=Ws(),dh=Y.flush(),ph=Y.sync(),yh=Y.end(),dr=class extends ch{constructor(e){super(),e=e||{},this.stream=e.stream||lh(e.ssl),typeof this.stream=="function"&&(this.stream=this.stream(e)),this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var t=this;this.on("newListener",function(n){n==="message"&&(t._emitMessage=!0)})}connect(e,t){var n=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,t),this.stream.once("connect",function(){n._keepAlive&&n.stream.setKeepAlive(!0,n._keepAliveInitialDelayMillis),n.emit("connect")});let i=o(function(s){n._ending&&(s.code==="ECONNRESET"||s.code==="EPIPE")||n.emit("error",s)},"reportStreamError");if(this.stream.on("error",i),this.stream.on("close",function(){n.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(s){var a=s.toString("utf8");switch(a){case"S":break;case"N":return n.stream.end(),n.emit("error",new Error("The server does not support SSL connections"));default:return n.stream.end(),n.emit("error",new Error("There was an error establishing an SSL connection"))}let u={socket:n.stream};n.ssl!==!0&&(Object.assign(u,n.ssl),"key"in n.ssl&&(u.key=n.ssl.key));var c=(xt(),K(Kt));c.isIP&&c.isIP(t)===0&&(u.servername=t);try{n.stream=fh(u)}catch(h){return n.emit("error",h)}n.attachListeners(n.stream),n.stream.on("error",i),n.emit("sslconnect")})}attachListeners(e){hh(e,t=>{var n=t.name==="error"?"errorMessage":t.name;this._emitMessage&&this.emit("message",t),this.emit(n,t)})}requestSsl(){this.stream.write(Y.requestSsl())}startup(e){this.stream.write(Y.startup(e))}cancel(e,t){this._send(Y.cancel(e,t))}password(e){this._send(Y.password(e))}sendSASLInitialResponseMessage(e,t){this._send(Y.sendSASLInitialResponseMessage(e,t))}sendSCRAMClientFinalMessage(e){this._send(Y.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(Y.query(e))}parse(e){this._send(Y.parse(e))}bind(e){this._send(Y.bind(e))}execute(e){this._send(Y.execute(e))}flush(){this.stream.writable&&this.stream.write(dh)}sync(){this._ending=!0,this._send(ph)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(yh,()=>{this.stream.end()})}close(e){this._send(Y.close(e))}describe(e){this._send(Y.describe(e))}sendCopyFromChunk(e){this._send(Y.copyData(e))}endCopyFrom(){this._send(Y.copyDone())}sendCopyFail(e){this._send(Y.copyFail(e))}};o(dr,"Connection");Gs.exports=dr});var An={};we(An,{join:()=>wh});function wh(...r){return r.join("/")}var En=ee(()=>{p();o(wh,"join")});var vn={};we(vn,{default:()=>mh});var mh,_n=ee(()=>{p();mh={}});var Vs={};we(Vs,{StringDecoder:()=>pr});var pr,zs=ee(()=>{p();pr=class{constructor(e){this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}};o(pr,"StringDecoder")});var Xs=L((Od,Zs)=>{"use strict";p();var{Transform:gh}=(_n(),K(vn)),{StringDecoder:Sh}=(zs(),K(Vs)),Re=Symbol("last"),yr=Symbol("decoder");function xh(r,e,t){let n;if(this.overflow){if(n=this[yr].write(r).split(this.matcher),n.length===1)return t();n.shift(),this.overflow=!1}else this[Re]+=this[yr].write(r),n=this[Re].split(this.matcher);this[Re]=n.pop();for(let i=0;i<n.length;i++)try{Ys(this,this.mapper(n[i]))}catch(s){return t(s)}if(this.overflow=this[Re].length>this.maxLength,this.overflow&&!this.skipOverflow){t(new Error("maximum buffer reached"));return}t()}o(xh,"transform");function bh(r){if(this[Re]+=this[yr].end(),this[Re])try{Ys(this,this.mapper(this[Re]))}catch(e){return r(e)}r()}o(bh,"flush");function Ys(r,e){e!==void 0&&r.push(e)}o(Ys,"push");function Js(r){return r}o(Js,"noop");function Ah(r,e,t){switch(r=r||/\r?\n/,e=e||Js,t=t||{},arguments.length){case 1:typeof r=="function"?(e=r,r=/\r?\n/):typeof r=="object"&&!(r instanceof RegExp)&&!r[Symbol.split]&&(t=r,r=/\r?\n/);break;case 2:typeof r=="function"?(t=e,e=r,r=/\r?\n/):typeof e=="object"&&(t=e,e=Js)}t=Object.assign({},t),t.autoDestroy=!0,t.transform=xh,t.flush=bh,t.readableObjectMode=!0;let n=new gh(t);return n[Re]="",n[yr]=new Sh("utf8"),n.matcher=r,n.mapper=e,n.maxLength=t.maxLength,n.skipOverflow=t.skipOverflow||!1,n.overflow=!1,n._destroy=function(i,s){this._writableState.errorEmitted=!1,s(i)},n}o(Ah,"split");Zs.exports=Ah});var wr={};we(wr,{default:()=>Eh});var Eh,mr=ee(()=>{p();Eh={}});var ra=L((jd,Le)=>{"use strict";p();var ea=(En(),K(An)),vh=(_n(),K(vn)).Stream,_h=Xs(),ta=(mr(),K(wr)),Ch=5432,gr=w.platform==="win32",bt=w.stderr,Uh=56,Ih=7,Lh=61440,Th=32768;function Bh(r){return(r&Lh)==Th}o(Bh,"isRegFile");var tt=["host","port","database","user","password"],Cn=tt.length,Ph=tt[Cn-1];function Un(){var r=bt instanceof vh&&bt.writable===!0;if(r){var e=Array.prototype.slice.call(arguments).concat(`
`);bt.write(ta.format.apply(ta,e))}}o(Un,"warn");Object.defineProperty(Le.exports,"isWin",{get:function(){return gr},set:function(r){gr=r}});Le.exports.warnTo=function(r){var e=bt;return bt=r,e};Le.exports.getFileName=function(r){var e=r||w.env,t=e.PGPASSFILE||(gr?ea.join(e.APPDATA||"./","postgresql","pgpass.conf"):ea.join(e.HOME||"./",".pgpass"));return t};Le.exports.usePgPass=function(r,e){return Object.prototype.hasOwnProperty.call(w.env,"PGPASSWORD")?!1:gr?!0:(e=e||"<unkn>",Bh(r.mode)?r.mode&(Uh|Ih)?(Un('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(Un('WARNING: password file "%s" is not a plain file',e),!1))};var Rh=Le.exports.match=function(r,e){return tt.slice(0,-1).reduce(function(t,n,i){return i==1&&Number(r[n]||Ch)===Number(e[n])?t&&!0:t&&(e[n]==="*"||e[n]===r[n])},!0)};Le.exports.getPassword=function(r,e,t){var n,i=e.pipe(_h());function s(c){var h=Mh(c);h&&Fh(h)&&Rh(r,h)&&(n=h[Ph],i.end())}o(s,"onLine");var a=o(function(){e.destroy(),t(n)},"onEnd"),u=o(function(c){e.destroy(),Un("WARNING: error on reading file: %s",c),t(void 0)},"onErr");e.on("error",u),i.on("data",s).on("end",a).on("error",u)};var Mh=Le.exports.parseLine=function(r){if(r.length<11||r.match(/^\s+#/))return null;for(var e="",t="",n=0,i=0,s=0,a={},u=!1,c=o(function(l,f,m){var b=r.substring(f,m);Object.hasOwnProperty.call(w.env,"PGPASS_NO_DEESCAPE")||(b=b.replace(/\\([:\\])/g,"$1")),a[tt[l]]=b},"addToObj"),h=0;h<r.length-1;h+=1){if(e=r.charAt(h+1),t=r.charAt(h),u=n==Cn-1,u){c(n,i);break}h>=0&&e==":"&&t!=="\\"&&(c(n,i,h+1),i=h+2,n+=1)}return a=Object.keys(a).length===Cn?a:null,a},Fh=Le.exports.isValidEntry=function(r){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},t=0;t<tt.length;t+=1){var n=e[t],i=r[tt[t]]||"",s=n(i);if(!s)return!1}return!0}});var ia=L((Gd,In)=>{"use strict";p();var Wd=(En(),K(An)),na=(rn(),K(tn)),Sr=ra();In.exports=function(r,e){var t=Sr.getFileName();na.stat(t,function(n,i){if(n||!Sr.usePgPass(i,t))return e(void 0);var s=na.createReadStream(t);Sr.getPassword(r,s,e)})};In.exports.warnTo=Sr.warnTo});var ua=L((zd,oa)=>{"use strict";p();var kh=Ie().EventEmitter,sa=pt(),Ln=rs(),Nh=en(),Dh=sn(),aa=ms(),Oh=dt(),qh=bn(),Qh=Xr(),At=class extends kh{constructor(e){super(),this.connectionParameters=new Dh(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var t=e||{};this._Promise=t.Promise||E.Promise,this._types=new Nh(t.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=t.connection||new qh({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||Oh.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=o(n=>{w.nextTick(()=>{n.handleError(e,this.connection)})},"enqueueError");this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){var t=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");w.nextTick(()=>{e(i)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){t.ssl?n.requestSsl():n.startup(t.getStartupConf())}),n.on("sslconnect",function(){n.startup(t.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),w.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,n)=>{this._connect(i=>{i?n(i):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{t.emit("error",n)});else if(this.password!==null)e();else try{ia()(this.connectionParameters,i=>{i!==void 0&&(this.connectionParameters.password=this.password=i),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let t=await Qh.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)}catch(t){this.emit("error",t)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=Ln.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(t){this.connection.emit("error",t)}})}async _handleAuthSASLContinue(e){try{await Ln.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(t){this.connection.emit("error",t)}}_handleAuthSASLFinal(e){try{Ln.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(t){this.connection.emit("error",t)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,t={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(t.application_name=n),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){var n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,n){return this._types.setTypeParser(e,t,n)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return sa.escapeIdentifier(e)}escapeLiteral(e){return sa.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&w.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,n){var i,s,a,u,c;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,s=i=e,typeof t=="function"&&(i.callback=i.callback||t)):(a=this.connectionParameters.query_timeout,i=new aa(e,t,n),i.callback||(s=new this._Promise((h,l)=>{i.callback=(f,m)=>f?l(f):h(m)}))),a&&(c=i.callback,u=setTimeout(()=>{var h=new Error("Query read timeout");w.nextTick(()=>{i.handleError(h,this.connection)}),c(h),i.callback=()=>{};var l=this.queryQueue.indexOf(i);l>-1&&this.queryQueue.splice(l,1),this._pulseQueryQueue()},a),i.callback=(h,l)=>{clearTimeout(u),c(h,l)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(w.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),s):(this.queryQueue.push(i),this._pulseQueryQueue(),s):(w.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),s)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};o(At,"Client");At.Query=aa;oa.exports=At});var fa=L((Zd,la)=>{"use strict";p();var Hh=Ie().EventEmitter,ca=o(function(){},"NOOP"),ha=o((r,e)=>{let t=r.findIndex(e);return t===-1?void 0:r.splice(t,1)[0]},"removeWhere"),br=class{constructor(e,t,n){this.client=e,this.idleListener=t,this.timeoutId=n}};o(br,"IdleItem");var De=class{constructor(e){this.callback=e}};o(De,"PendingItem");function jh(){throw new Error("Release called on client which has already been released to the pool.")}o(jh,"throwOnDoubleRelease");function xr(r,e){if(e)return{callback:e,result:void 0};let t,n,i=o(function(a,u){a?t(a):n(u)},"cb"),s=new r(function(a,u){n=a,t=u});return{callback:i,result:s}}o(xr,"promisify");function Kh(r,e){return o(function t(n){n.client=e,e.removeListener("error",t),e.on("error",()=>{r.log("additional client error after disconnection due to error",n)}),r._remove(e),r.emit("error",n,e)},"idleListener")}o(Kh,"makeIdleListener");var Ar=class extends Hh{constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||Er().Client,this.Promise=this.options.Promise||E.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let n=t.client;n.ref&&n.ref();let i=t.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e){let t=ha(this._idle,n=>n.client===e);t!==void 0&&clearTimeout(t.timeoutId),this._clients=this._clients.filter(n=>n!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let t=xr(this.Promise,e),n=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&w.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new De(t.callback)),n;let i=o((u,c,h)=>{clearTimeout(a),t.callback(u,c,h)},"queueCallback"),s=new De(i),a=setTimeout(()=>{ha(this._pendingQueue,u=>u.callback===i),s.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(s),n}return this.newClient(new De(t.callback)),n}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let n=Kh(this,t);this.log("checking client timeout");let i,s=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),s=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(a=>{if(i&&clearTimeout(i),t.on("error",n),a)this.log("client failed to connect",a),this._clients=this._clients.filter(u=>u!==t),s&&(a.message="Connection terminated due to connection timeout"),this._pulseQueue(),e.timedOut||e.callback(a,void 0,ca);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let u=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(h=>h.client===t)!==-1&&this._acquireClient(t,new De((h,l,f)=>f()),n,!1)},this.options.maxLifetimeSeconds*1e3);u.unref(),t.once("end",()=>clearTimeout(u))}return this._acquireClient(t,e,n,!0)}})}_acquireClient(e,t,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),t.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,s=>{if(s)return e.release(s),t.callback(s,void 0,ca);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let n=!1;return i=>{n&&jh(),n=!0,this._release(e,t,i)}}_release(e,t,n){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}if(this._expired.has(e)){this.log("remove expired client"),this._expired.delete(e),this._remove(e),this._pulseQueue();return}let s;this.options.idleTimeoutMillis&&(s=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&s.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new br(e,t,s)),this._pulseQueue()}query(e,t,n){if(typeof e=="function"){let s=xr(this.Promise,e);return v(function(){return s.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),s.result}typeof t=="function"&&(n=t,t=void 0);let i=xr(this.Promise,n);return n=i.callback,this.connect((s,a)=>{if(s)return n(s);let u=!1,c=o(h=>{u||(u=!0,a.release(h),n(h))},"onError");a.once("error",c),this.log("dispatching query");try{a.query(e,t,(h,l)=>{if(this.log("query dispatched"),a.removeListener("error",c),!u)return u=!0,a.release(h),h?n(h):n(void 0,l)})}catch(h){return a.release(h),n(h)}}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let t=xr(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};o(Ar,"Pool");la.exports=Ar});var da={};we(da,{default:()=>$h});var $h,pa=ee(()=>{p();$h={}});var ma=L((r0,wa)=>{"use strict";p();var ya=Ie().EventEmitter,Wh=(mr(),K(wr)),Tn=pt(),rt=wa.exports=function(r,e,t){ya.call(this),r=Tn.normalizeQueryConfig(r,e,t),this.text=r.text,this.values=r.values,this.name=r.name,this.callback=r.callback,this.state="new",this._arrayMode=r.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};Wh.inherits(rt,ya);var Gh={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};rt.prototype.handleError=function(r){var e=this.native.pq.resultErrorFields();if(e)for(var t in e){var n=Gh[t]||t;r[n]=e[t]}this.callback?this.callback(r):this.emit("error",r),this.state="error"};rt.prototype.then=function(r,e){return this._getPromise().then(r,e)};rt.prototype.catch=function(r){return this._getPromise().catch(r)};rt.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(r,e){this._once("end",r),this._once("error",e)}.bind(this)),this._promise)};rt.prototype.submit=function(r){this.state="running";var e=this;this.native=r.native,r.native.arrayMode=this._arrayMode;var t=o(function(s,a,u){if(r.native.arrayMode=!1,v(function(){e.emit("_done")}),s)return e.handleError(s);e._emitRowEvents&&(u.length>1?a.forEach((c,h)=>{c.forEach(l=>{e.emit("row",l,u[h])})}):a.forEach(function(c){e.emit("row",c,u)})),e.state="end",e.emit("end",u),e.callback&&e.callback(null,u)},"after");if(w.domain&&(t=w.domain.bind(t)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var n=(this.values||[]).map(Tn.prepareValue);if(r.namedQueries[this.name]){if(this.text&&r.namedQueries[this.name]!==this.text){let s=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return t(s)}return r.native.execute(this.name,n,t)}return r.native.prepare(this.name,this.text,n.length,function(s){return s?t(s):(r.namedQueries[e.name]=e.text,e.native.execute(e.name,n,t))})}else if(this.values){if(!Array.isArray(this.values)){let s=new Error("Query values must be an array");return t(s)}var i=this.values.map(Tn.prepareValue);r.native.query(this.text,i,t)}else r.native.query(this.text,t)}});var Aa=L((s0,ba)=>{"use strict";p();var ga;try{ga=(pa(),K(da))}catch(r){throw r}var Vh=en(),Sa=Ie().EventEmitter,zh=(mr(),K(wr)),Jh=sn(),xa=ma(),de=ba.exports=function(r){Sa.call(this),r=r||{},this._Promise=r.Promise||E.Promise,this._types=new Vh(r.types),this.native=new ga({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var e=this.connectionParameters=new Jh(r);this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};de.Query=xa;zh.inherits(de,Sa);de.prototype._errorAllQueries=function(r){let e=o(t=>{w.nextTick(()=>{t.native=this.native,t.handleError(r)})},"enqueueError");this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};de.prototype._connect=function(r){var e=this;if(this._connecting){w.nextTick(()=>r(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(t,n){if(t)return r(t);e.native.connect(n,function(i){if(i)return e.native.end(),r(i);e._connected=!0,e.native.on("error",function(s){e._queryable=!1,e._errorAllQueries(s),e.emit("error",s)}),e.native.on("notification",function(s){e.emit("notification",{channel:s.relname,payload:s.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),r()})})};de.prototype.connect=function(r){if(r){this._connect(r);return}return new this._Promise((e,t)=>{this._connect(n=>{n?t(n):e()})})};de.prototype.query=function(r,e,t){var n,i,s,a,u;if(r==null)throw new TypeError("Client was passed a null or undefined query");if(typeof r.submit=="function")s=r.query_timeout||this.connectionParameters.query_timeout,i=n=r,typeof e=="function"&&(r.callback=e);else if(s=this.connectionParameters.query_timeout,n=new xa(r,e,t),!n.callback){let c,h;i=new this._Promise((l,f)=>{c=l,h=f}),n.callback=(l,f)=>l?h(l):c(f)}return s&&(u=n.callback,a=setTimeout(()=>{var c=new Error("Query read timeout");w.nextTick(()=>{n.handleError(c,this.connection)}),u(c),n.callback=()=>{};var h=this._queryQueue.indexOf(n);h>-1&&this._queryQueue.splice(h,1),this._pulseQueryQueue()},s),n.callback=(c,h)=>{clearTimeout(a),u(c,h)}),this._queryable?this._ending?(n.native=this.native,w.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,w.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};de.prototype.end=function(r){var e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,r));var t;return r||(t=new this._Promise(function(n,i){r=o(s=>s?i(s):n(),"cb")})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),w.nextTick(()=>{e.emit("end"),r&&r()})}),t};de.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};de.prototype._pulseQueryQueue=function(r){if(!!this._connected&&!this._hasActiveQuery()){var e=this._queryQueue.shift();if(!e){r||this.emit("drain");return}this._activeQuery=e,e.submit(this);var t=this;e.once("_done",function(){t._pulseQueryQueue()})}};de.prototype.cancel=function(r){this._activeQuery===r?this.native.cancel(function(){}):this._queryQueue.indexOf(r)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(r),1)};de.prototype.ref=function(){};de.prototype.unref=function(){};de.prototype.setTypeParser=function(r,e,t){return this._types.setTypeParser(r,e,t)};de.prototype.getTypeParser=function(r,e){return this._types.getTypeParser(r,e)}});var Bn=L((u0,Ea)=>{"use strict";p();Ea.exports=Aa()});var Er=L((l0,Et)=>{"use strict";p();var Yh=ua(),Zh=dt(),Xh=bn(),el=fa(),{DatabaseError:tl}=Sn(),{escapeIdentifier:rl,escapeLiteral:nl}=pt(),il=o(r=>o(class extends el{constructor(t){super(t,r)}},"BoundPool"),"poolFactory"),Pn=o(function(r){this.defaults=Zh,this.Client=r,this.Query=this.Client.Query,this.Pool=il(this.Client),this._pools=[],this.Connection=Xh,this.types=ft(),this.DatabaseError=tl,this.escapeIdentifier=rl,this.escapeLiteral=nl},"PG");typeof w.env.NODE_PG_FORCE_NATIVE<"u"?Et.exports=new Pn(Bn()):(Et.exports=new Pn(Yh),Object.defineProperty(Et.exports,"native",{configurable:!0,enumerable:!1,get(){var r=null;try{r=new Pn(Bn())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Et.exports,"native",{value:r}),r}}))});var ol={};we(ol,{Client:()=>vt,ClientBase:()=>pe.ClientBase,Connection:()=>pe.Connection,DatabaseError:()=>pe.DatabaseError,Pool:()=>vr,Query:()=>pe.Query,default:()=>al,defaults:()=>pe.defaults,neonConfig:()=>ce,types:()=>pe.types});module.exports=K(ol);p();var _r=st(Er());xt();p();p();function va(r,e=!1){let{protocol:t}=new URL(r),n="http:"+r.substring(t.length),{username:i,password:s,host:a,hostname:u,port:c,pathname:h,search:l,searchParams:f,hash:m}=new URL(n);s=decodeURIComponent(s);let b=i+":"+s,x=e?Object.fromEntries(f.entries()):l;return{href:r,protocol:t,auth:b,username:i,password:s,host:a,hostname:u,port:c,pathname:h,search:l,query:x,hash:m}}o(va,"parse");var nt=class extends Error{constructor(){super(...arguments);S(this,"code",null);S(this,"name","NeonDbError")}};o(nt,"NeonDbError");var sl=new Set([1007,1009,1040,651,114,3802,16]);function Rn(r,e,t){let n=va(r),{protocol:i,username:s,password:a,host:u,pathname:c}=n;if(i!=="postgres:"&&i!=="postgresql:"||!u||!s||!a||!c)throw new Error("Database connection string format should be: postgres://user:password@host.tld/dbname?option=value");return async function(h,...l){let f="";for(let x=0;x<h.length;x++)f+=h[x],x<l.length&&(f+="$"+(x+1));let m,b;try{let x=`https://${u}/sql`;m={query:f,params:l},e&&e(m);let I=JSON.stringify(m);b=await fetch(x,{body:I,method:"POST",headers:{"Neon-Connection-String":r}})}catch(x){throw new nt(`Error connecting to database: ${x.message}`)}if(b.ok){let x=await b.json(),I=Object.fromEntries(x.fields.map(B=>[B.name,sl.has(B.dataTypeID)?U=>U:pe.types.getTypeParser(B.dataTypeID)])),T=x.rows.map(B=>Object.fromEntries(Object.entries(B).map(([U,A])=>[U,A===null?A:I[U](A)])));return t&&t(m,x,T),T}else{let{status:x}=b;if(x===400){let{message:I,code:T}=await b.json(),B=new nt(I);throw B.code=T,B}else{let I=await b.text();throw new nt(`Database error (HTTP status ${x}): ${I}`)}}}}o(Rn,"db");var pe=st(Er());var al=Rn,vt=class extends _r.Client{get neonConfig(){return this.connection.stream}connect(e){this.ssl&&this.neonConfig.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL on the Postgres connection."),this.host==="localhost"&&console.warn("The database host is 'localhost', which is the default host when none is set. If that's intentional, please ignore this warning. If not, perhaps an environment variable has not been set, or has not been passed to the library?");let t=super.connect(e),n=this.neonConfig.pipelineTLS&&this.ssl,i=this.neonConfig.pipelineConnect==="password";if(!n&&!this.neonConfig.pipelineConnect)return t;let s=this.connection;if(n&&s.on("connect",()=>s.stream.emit("data","S")),i){s.removeAllListeners("authenticationCleartextPassword"),s.removeAllListeners("readyForQuery"),s.once("readyForQuery",()=>s.on("readyForQuery",this._handleReadyForQuery.bind(this)));let a=this.ssl?"sslconnect":"connect";s.on(a,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return t}async _handleAuthSASLContinue(e){let t=this.saslSession,n=this.password,i=e.data;if(t.message!=="SASLInitialResponse"||typeof n!="string"||typeof i!="string")throw new Error("SASL: protocol error");let s=Object.fromEntries(i.split(",").map(oe=>{if(!/^.=/.test(oe))throw new Error("SASL: Invalid attribute pair entry");let te=oe[0],G=oe.substring(2);return[te,G]})),a=s.r,u=s.s,c=s.i;if(!a||!/^[!-+--~]+$/.test(a))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!u||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(u))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!c||!/^[1-9][0-9]*$/.test(c))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!a.startsWith(t.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(a.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let h=parseInt(c,10),l=y.from(u,"base64"),f=new TextEncoder,m=f.encode(n),b=await g.subtle.importKey("raw",m,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),x=new Uint8Array(await g.subtle.sign("HMAC",b,y.concat([l,y.from([0,0,0,1])]))),I=x;for(var T=0;T<h-1;T++)x=new Uint8Array(await g.subtle.sign("HMAC",b,x)),I=y.from(I.map((oe,te)=>I[te]^x[te]));let B=I,U=await g.subtle.importKey("raw",B,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),A=new Uint8Array(await g.subtle.sign("HMAC",U,f.encode("Client Key"))),Z=await g.subtle.digest("SHA-256",A),ae="n=*,r="+t.clientNonce,j="r="+a+",s="+u+",i="+h,V="c=biws,r="+a,k=ae+","+j+","+V,ye=await g.subtle.importKey("raw",Z,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var P=new Uint8Array(await g.subtle.sign("HMAC",ye,f.encode(k))),M=y.from(A.map((oe,te)=>A[te]^P[te])),N=M.toString("base64");let Q=await g.subtle.importKey("raw",B,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),$=await g.subtle.sign("HMAC",Q,f.encode("Server Key")),W=await g.subtle.importKey("raw",$,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var D=y.from(await g.subtle.sign("HMAC",W,f.encode(k)));t.message="SASLResponse",t.serverSignature=D.toString("base64"),t.response=V+",p="+N,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};o(vt,"NeonClient");var vr=class extends _r.Pool{constructor(){super(...arguments);S(this,"Client",vt)}};o(vr,"NeonPool");
